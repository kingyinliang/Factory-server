webpackJsonp([31,90],{"2D9T":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("BO1k"),s=a.n(r),l=a("woOf"),i=a.n(l),o=a("Lna1"),c=a("P9l9"),n={name:"material",data:function(){return{formLabelWidth:"100px",pulpMachineList:[],hovercraftList:[],hovercraftAll:[],dialogFormVisibleMai:!1,visible:!1,materialList:[],sauce:{},saucerule:{pulpMachine:[{required:!0,message:"请选择布浆机",trigger:"change"}],hovercraftNo:[{required:!0,message:"请选择气垫车",trigger:"change"}]},classesList:["白班","中班","夜班"],peopleList:[],selctId:[],userlist:[],filterMethod:function(e,t){return t.screncon.indexOf(e)>-1},multipleSelection:[],isSelect:!0,guanTwoDisplayNo:!0,sauceClassList:[]}},props:["isRedact","formHeader"],mounted:function(){Object(o.b)(this.$),this.GetsauceClass()},watch:{},methods:{GetsauceClass:function(){var e=this;this.$http(c.k.PARAMETERLIST_API+"?type=YA_M_MATERIAL","POST").then(function(t){var a=t.data;0===a.code?e.sauceClassList=a.dicList:e.$message.error(a.msg)})},addGuan:function(){this.guanTwoDisplayNo=!1},delGuan:function(){this.sauce.potTwo="",this.guanTwoDisplayNo=!0},cancelsave:function(){this.dialogFormVisibleMai=!1,this.delGuan()},GetpulpMachine:function(e){var t=this;this.$http(""+c.c.DEVICELIST_API,"POST",{param:"布浆机",deptId:e,currPage:"1",pageSize:"50"}).then(function(e){var a=e.data;0===a.code?t.pulpMachineList=a.list.list:t.$message.error(a.msg)})},GethovercraftNo:function(e){var t=this;this.$http(""+c.c.DEVICELIST_API,"POST",{param:"气垫车",deptId:e,currPage:"1",pageSize:"50",status:"0"}).then(function(e){var a=e.data;0===a.code?t.hovercraftList=a.list.list:t.$message.error(a.msg)}),this.$http(""+c.c.DEVICELIST_API,"POST",{param:"气垫车",deptId:e,currPage:"1",pageSize:"50"}).then(function(e){var a=e.data;0===a.code?t.hovercraftAll=a.list.list:t.$message.error(a.msg)})},addmaterial:function(){this.dialogFormVisibleMai=!0,this.isSelect=!0,this.guanTwoDisplayNo=!0,this.sauce={id:"",uid:this.uuid(),pulpMachine:"",hovercraftNo:"",pulpNum:"",pulpStartDate:"",pulpEndDate:"",pulpAmount:"",unit:"L",selfDrenchTime:"",potOne:"",potTwo:"",changed:Object(o.c)(new Date,"yyyy-MM-dd hh:mm:ss"),changer:this.$store.state.user.realName+"("+this.$store.state.user.name+")",delFlag:"0",clothNo:"",sauceClass:""}},editmaterial:function(e){this.isRedact&&(this.dialogFormVisibleMai=!0,this.isSelect=!1,this.sauce=i()({},e),this.sauce.potTwo&&(this.guanTwoDisplayNo=!1))},addsave:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;var a=[];a=t.sauce.hasOwnProperty("uid")?t.materialList.filter(function(e){return e.uid===t.sauce.uid}):t.materialList.filter(function(e){return e.id===t.sauce.id});var r=t.pulpMachineList.find(function(e){return e.deviceId===t.sauce.pulpMachine}).deviceName,s=t.hovercraftAll.find(function(e){return e.deviceId===t.sauce.hovercraftNo}).deviceName;t.sauce={id:t.sauce.id,uid:t.sauce.uid,pulpMachine:t.sauce.pulpMachine,hovercraftNo:t.sauce.hovercraftNo,pulpMachineName:r,hovercraftName:s,pulpNum:t.sauce.pulpNum,pulpStartDate:t.sauce.pulpStartDate,pulpEndDate:t.sauce.pulpEndDate,pulpAmount:t.sauce.pulpAmount,unit:"L",selfDrenchTime:t.sauce.selfDrenchTime,potOne:t.sauce.potOne,potTwo:t.sauce.potTwo,changed:Object(o.c)(new Date,"yyyy-MM-dd hh:mm:ss"),changer:t.$store.state.user.realName+"("+t.$store.state.user.name+")",delFlag:t.sauce.delFlag,clothNo:t.sauce.clothNo,sauceClass:t.sauce.sauceClass};var l=void 0;t.sauce.pulpEndDate&&t.sauce.pulpStartDate?(l=(new Date(t.sauce.pulpEndDate)-new Date(t.sauce.pulpStartDate))/6e4,t.$set(t.sauce,"pulpTime",l)):t.$set(t.sauce,"pulpTime",0),a&&a.length>0?i()(a[0],t.sauce):t.materialList.push(t.sauce),t.dialogFormVisibleMai=!1})},GetMateriaList:function(e){var t=this;this.GetpulpMachine(e.productLine),this.GethovercraftNo(e.workShop),this.$http(""+c.j.CLOTHMATERIALIST_API,"POST",{factory:e.factory,workShop:e.workShop,productLine:e.productLine,productDate:e.productDate}).then(function(e){var a=e.data;0===a.code?(0!==a.prspro.length&&(t.formHeader.id=a.prspro[0].id),t.materialList=a.propulp,t.peopleList=a.propulpMan):t.$message.error(a.msg)}).finally(function(){t.$emit("setApplyMaterielState","未录入")})},Readyrules:function(){var e=!0;if(0===this.multipleSelection.length)return e=!1,this.$message.error("请勾选提交数据"),!1;var t=!0,a=!1,r=void 0;try{for(var l,i=s()(this.multipleSelection);!(t=(l=i.next()).done);t=!0){var o=l.value;if(!(o.pulpMachineName&&""!==o.pulpMachineName&&o.hovercraftName&&""!==o.hovercraftName&&o.pulpStartDate&&""!==o.pulpStartDate&&o.pulpEndDate&&""!==o.pulpEndDate&&o.pulpAmount&&""!==o.pulpAmount&&o.selfDrenchTime&&""!==o.selfDrenchTime&&o.potOne&&""!==o.potOne&&o.sauceClass&&""!==o.sauceClass))return e=!1,this.$message.error("物料必填项不能为空"),!1}}catch(e){a=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(a)throw r}}if(0===this.peopleList.length)return e=!1,this.$message.error("请填写布浆人员"),!1;var c=!0,n=!1,u=void 0;try{for(var d,p=s()(this.peopleList);!(c=(d=p.next()).done);c=!0){var f=d.value;if(!f.classes||""===f.classes||!f.man||""===f.man)return e=!1,this.$message.error("人员必填项不能为空"),!1}}catch(e){n=!0,u=e}finally{try{!c&&p.return&&p.return()}finally{if(n)throw u}}var m=!0,h=!1,v=void 0;try{for(var b,_=s()(this.multipleSelection);!(m=(b=_.next()).done);m=!0){if(""===b.value.id)return e=!1,this.$message.error("请先保存再提交"),!1}}catch(e){h=!0,v=e}finally{try{!m&&_.return&&_.return()}finally{if(h)throw v}}return e},savemain:function(e,t){var a=this;this.formHeader.id||(this.formHeader.id=this.uuid(32,62)),this.formHeader.addOrUpdate="0",this.$http(""+c.j.CLOTHFORMHEADER_API,"POST",this.formHeader).then(function(t){var r=t.data;0===r.code||a.$message.error(r.msg),e&&e("resolve")}).catch(function(){e&&t("reject")})},savesecond:function(e,t){var a=this;this.materialList.map(function(e){a.$set(e,"processId",a.formHeader.id),a.$set(e,"productLine",a.formHeader.productLine),a.$set(e,"status","saved"),"submit"===a.formHeader.clickstatus&&a.multipleSelection.length>0&&a.multipleSelection.find(function(t){return t.uid===e.uid})&&a.$set(e,"status","submit")}),"submit"===this.formHeader.clickstatus&&(this.multipleSelection.map(function(e){a.$set(e,"processId",a.formHeader.id),a.$set(e,"productLine",a.formHeader.productLine),a.$set(e,"status",a.formHeader.clickstatus)}),this.$http(""+c.j.CLOTHMATERIALSUBMIT_API,"POST",this.multipleSelection).then(function(e){var t=e.data;0===t.code||a.$message.error(t.msg)})),this.$http(""+c.j.CLOTHMATERIALSAVE_API,"POST",this.materialList).then(function(t){var r=t.data;0===r.code||a.$message.error(r.msg),e&&e("resolve")}).catch(function(){e&&t("reject")})},savepeople:function(e,t){var a=this;this.peopleList.map(function(e){a.$set(e,"processId",a.formHeader.id)}),this.$http(""+c.j.CLOTHMATERIALMAN_API,"POST",this.peopleList).then(function(t){var r=t.data;0===r.code||a.$message.error(r.msg),e&&e("resolve")}).catch(function(){e&&t("reject")})},delrow:function(e){e.delFlag="1"},rowDelFlag:function(e){var t=e.row;e.rowIndex;return"1"===t.delFlag?"rowDel":""},addpeople:function(){this.peopleList.push({id:"",classes:"",delFlag:"0"})},selectUser:function(e){var t=this;this.isRedact&&(this.row=e,this.$http(""+c.k.USERLIST_API,"POST",{deptId:this.formHeader.workShop}).then(function(e){var a=e.data;0===a.code?(t.userlist=Object(o.j)(a.page.list),t.row.man&&(t.selctId=t.row.man.split(",")),t.visible=!0):t.$message.error(a.msg)}))},updatauser:function(e){this.$set(e,"man",this.selctId.join(",")),this.selctId=[],this.visible=!1},handleSelectionChange:function(e){var t=!0,a=!1,r=void 0;try{for(var l,i=s()(e);!(t=(l=i.next()).done);t=!0){var o=l.value;""!==o.uid&&o.uid||this.$set(o,"uid",o.id)}}catch(e){a=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(a)throw r}}this.multipleSelection=e}},computed:{},components:{}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",[a("div",{staticStyle:{overflow:"hidden"}},[a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"small",disabled:!e.isRedact},on:{click:e.addmaterial}},[e._v(" + 新增")])],1),e._v(" "),a("div",{staticStyle:{"margin-top":"10px"}},[a("el-table",{attrs:{data:e.materialList,border:"","header-row-class-name":"tableHead","row-class-name":e.rowDelFlag},on:{"selection-change":e.handleSelectionChange,"row-dblclick":e.editmaterial}},[a("el-table-column",{attrs:{type:"selection",width:"35",disabled:!e.isRedact}}),e._v(" "),a("el-table-column",{attrs:{type:"index",label:"序号",width:"50px"}}),e._v(" "),a("el-table-column",{attrs:{width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.pulpMachineName))]}}])},[a("template",{slot:"header"},[a("i",{staticClass:"reqI"},[e._v("*")]),a("span",[e._v("布浆机")])])],2),e._v(" "),a("el-table-column",{attrs:{width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.hovercraftName))]}}])},[a("template",{slot:"header"},[a("i",{staticClass:"reqI"},[e._v("*")]),a("span",[e._v("气垫小车号")])])],2),e._v(" "),a("el-table-column",{attrs:{prop:"pulpNum",label:"布浆张数"}}),e._v(" "),a("el-table-column",{attrs:{width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.pulpStartDate))]}}])},[a("template",{slot:"header"},[a("i",{staticClass:"reqI"},[e._v("*")]),a("span",[e._v("布浆开始时间")])])],2),e._v(" "),a("el-table-column",{attrs:{width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.pulpEndDate))]}}])},[a("template",{slot:"header"},[a("i",{staticClass:"reqI"},[e._v("*")]),a("span",[e._v("布浆结束时间")])])],2),e._v(" "),a("el-table-column",{attrs:{prop:"pulpTime",label:"布浆时间合计(MIN)",width:"150px"}}),e._v(" "),a("el-table-column",{scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.pulpAmount))]}}])},[a("template",{slot:"header"},[a("i",{staticClass:"reqI"},[e._v("*")]),a("span",[e._v("布浆量")])])],2),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.clothNo))]}}])},[a("template",{slot:"header"},[e._v("布号")])],2),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.sauceClass))]}}])},[a("template",{slot:"header"},[a("i",{staticClass:"reqI"},[e._v("*")]),a("span",[e._v("酱醪分类")])])],2),e._v(" "),a("el-table-column",{attrs:{prop:"unit",label:"单位"}}),e._v(" "),a("el-table-column",{attrs:{width:"160px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.selfDrenchTime))]}}])},[a("template",{slot:"header"},[a("i",{staticClass:"reqI"},[e._v("*")]),a("span",[e._v("布浆自淋时间(MIN)")])])],2),e._v(" "),a("el-table-column",{attrs:{width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.potOne))]}}])},[a("template",{slot:"header"},[a("i",{staticClass:"reqI"},[e._v("*")]),a("span",[e._v("发酵罐号1")])])],2),e._v(" "),a("el-table-column",{attrs:{prop:"potTwo",label:"发酵罐号2",width:"150px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"remark",label:"操作",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",disabled:!e.isRedact,circle:"",size:"small"},on:{click:function(a){return e.delrow(t.row)}}})]}}])})],1)],1)]),e._v(" "),a("el-card",[a("div",[a("span",{staticClass:"lh32px"},[e._v("布浆人员")]),e._v(" "),a("el-button",{staticClass:"readyshiftBtn",staticStyle:{"margin-left":"30px"},attrs:{type:"text",name:"people"}},[e._v("收起"),a("i",{staticClass:"el-icon-caret-top"})]),e._v(" "),a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"small",disabled:!e.isRedact},on:{click:e.addpeople}},[e._v(" + 新增")])],1),e._v(" "),a("div",{staticClass:"peopleBox"},[a("el-table",{ref:"peopleTable",staticStyle:{"margin-top":"10px"},attrs:{border:"","header-row-class-name":"tableHead",data:e.peopleList,"row-class-name":e.rowDelFlag}},[a("el-table-column",{attrs:{label:"白/中/夜班"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{placeholder:"请选择",size:"small",disabled:!e.isRedact},model:{value:t.row.classes,callback:function(a){e.$set(t.row,"classes",a)},expression:"scope.row.classes"}},e._l(e.classesList,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}),1)]}}])},[a("template",{slot:"header"},[a("i",{staticClass:"reqI"},[e._v("*")]),a("span",[e._v("白/中/夜班")])])],2),e._v(" "),a("el-table-column",{attrs:{label:"人员","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.man?a("span",{style:{cursor:e.isRedact?"pointer":""},on:{click:function(a){return e.selectUser(t.row)}}},[e._v(e._s(t.row.man))]):a("el-col",[a("span",{style:{cursor:e.isRedact?"pointer":""},on:{click:function(a){return e.selectUser(t.row)}}},[a("i",[e._v(e._s(t.row.man))]),e._v(" "),a("i",[e._v("点击选择人员")])])])]}}])},[a("template",{slot:"header"},[a("i",{staticClass:"reqI"},[e._v("*")]),a("span",[e._v("人员")])])],2),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",disabled:!e.isRedact,circle:"",size:"small"},on:{click:function(a){return e.delrow(t.row)}}})]}}])})],1)],1)]),e._v(" "),a("el-dialog",{attrs:{title:"熟酱醪领用",visible:e.dialogFormVisibleMai,width:"450px"},on:{"update:visible":function(t){e.dialogFormVisibleMai=t}}},[a("el-form",{ref:"saucesbu",attrs:{model:e.sauce,size:"small",rules:e.saucerule}},[a("el-form-item",{attrs:{label:"布浆机","label-width":e.formLabelWidth,prop:"pulpMachine"}},[a("el-select",{staticStyle:{width:"310px"},attrs:{filterable:"",placeholder:"请选择"},model:{value:e.sauce.pulpMachine,callback:function(t){e.$set(e.sauce,"pulpMachine",t)},expression:"sauce.pulpMachine"}},e._l(e.pulpMachineList,function(e,t){return a("el-option",{key:t,attrs:{label:e.deviceName,value:e.deviceId}})}),1)],1),e._v(" "),this.sauce.hovercraftNo?a("el-form-item",{attrs:{label:"气垫小车","label-width":e.formLabelWidth,prop:"hovercraftNo"}},[a("el-select",{staticStyle:{width:"310px"},attrs:{filterable:"",placeholder:"请选择",disabled:!e.isSelect},model:{value:e.sauce.hovercraftNo,callback:function(t){e.$set(e.sauce,"hovercraftNo",t)},expression:"sauce.hovercraftNo"}},e._l(e.hovercraftAll,function(e,t){return a("el-option",{key:t,attrs:{label:e.deviceName,value:e.deviceId}})}),1)],1):a("el-form-item",{attrs:{label:"气垫小车","label-width":e.formLabelWidth,prop:"hovercraftNo"}},[a("el-select",{staticStyle:{width:"310px"},attrs:{filterable:"",placeholder:"请选择",disabled:!e.isSelect},model:{value:e.sauce.hovercraftNo,callback:function(t){e.$set(e.sauce,"hovercraftNo",t)},expression:"sauce.hovercraftNo"}},e._l(e.hovercraftList,function(e,t){return a("el-option",{key:t,attrs:{label:e.deviceName,value:e.deviceId}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"布浆张数","label-width":e.formLabelWidth,prop:"pulpNum"}},[a("el-input",{model:{value:e.sauce.pulpNum,callback:function(t){e.$set(e.sauce,"pulpNum",t)},expression:"sauce.pulpNum"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"布浆开始时间","label-width":e.formLabelWidth,prop:"pulpStartDate"}},[a("el-date-picker",{staticStyle:{width:"310px"},attrs:{type:"datetime",placeholder:"选择日期",format:"yyyy-MM-dd HH:mm","value-format":"yyyy-MM-dd HH:mm"},model:{value:e.sauce.pulpStartDate,callback:function(t){e.$set(e.sauce,"pulpStartDate",t)},expression:"sauce.pulpStartDate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"布浆结束时间","label-width":e.formLabelWidth,prop:"pulpEndDate"}},[a("el-date-picker",{staticStyle:{width:"310px"},attrs:{type:"datetime",placeholder:"选择日期",format:"yyyy-MM-dd HH:mm","value-format":"yyyy-MM-dd HH:mm"},model:{value:e.sauce.pulpEndDate,callback:function(t){e.$set(e.sauce,"pulpEndDate",t)},expression:"sauce.pulpEndDate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"布浆量","label-width":e.formLabelWidth,prop:"pulpAmount"}},[a("el-input",{model:{value:e.sauce.pulpAmount,callback:function(t){e.$set(e.sauce,"pulpAmount",t)},expression:"sauce.pulpAmount"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"自重自淋时间","label-width":e.formLabelWidth,prop:"selfDrenchTime"}},[a("el-input",{model:{value:e.sauce.selfDrenchTime,callback:function(t){e.$set(e.sauce,"selfDrenchTime",t)},expression:"sauce.selfDrenchTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"布号","label-width":e.formLabelWidth,prop:"clothNo"}},[a("el-input",{model:{value:e.sauce.clothNo,callback:function(t){e.$set(e.sauce,"clothNo",t)},expression:"sauce.clothNo"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"酱醪分类","label-width":e.formLabelWidth,prop:"sauceClass"}},[a("el-select",{staticStyle:{width:"310px"},attrs:{filterable:"",placeholder:"请选择"},model:{value:e.sauce.sauceClass,callback:function(t){e.$set(e.sauce,"sauceClass",t)},expression:"sauce.sauceClass"}},e._l(e.sauceClassList,function(e,t){return a("el-option",{key:t,attrs:{label:e.code+" "+e.name,value:e.code+" "+e.name}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"发酵罐号","label-width":e.formLabelWidth,prop:"potOne"}},[a("el-input",{staticStyle:{width:"259px",float:"left"},model:{value:e.sauce.potOne,callback:function(t){e.$set(e.sauce,"potOne",t)},expression:"sauce.potOne"}}),a("el-button",{staticStyle:{float:"left","margin-left":"10px"},on:{click:function(t){return e.addGuan()}}},[e._v("+")])],1),e._v(" "),a("el-form-item",{style:{display:e.guanTwoDisplayNo?"none":""},attrs:{label:"发酵罐号2","label-width":e.formLabelWidth,prop:"potTwo"}},[a("el-input",{staticStyle:{width:"259px",float:"left"},model:{value:e.sauce.potTwo,callback:function(t){e.$set(e.sauce,"potTwo",t)},expression:"sauce.potTwo"}}),a("el-button",{staticStyle:{float:"left","margin-left":"10px"},attrs:{type:"danger",icon:"el-icon-delete",circle:"",size:"small"},on:{click:function(t){return e.delGuan()}}})],1),e._v(" "),a("el-form-item",{attrs:{label:"操作时间","label-width":e.formLabelWidth}},[e._v(e._s(e.sauce.changed))]),e._v(" "),a("el-form-item",{attrs:{label:"操作人","label-width":e.formLabelWidth}},[e._v(e._s(e.sauce.changer))])],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.cancelsave()}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addsave("saucesbu")}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"人员分配","close-on-click-modal":!1,visible:e.visible},on:{"update:visible":function(t){e.visible=t}}},[a("el-row",[a("el-col",{staticStyle:{width:"500px"}},[a("el-transfer",{attrs:{filterable:"",titles:["未分配人员","已分配人员"],"filter-method":e.filterMethod,"filter-placeholder":"请输入用户名称",data:e.userlist},model:{value:e.selctId,callback:function(t){e.selctId=t},expression:"selctId"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticStyle:{border:"1px solid #dcdfe6",padding:"12px 20px","font-size":"14px","border-radius":"4px"},on:{click:function(t){e.visible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{staticStyle:{"background-color":"#1890FF",padding:"12px 20px","font-size":"14px","border-radius":"4px"},attrs:{type:"primary"},on:{click:function(t){return e.updatauser(e.row)}}},[e._v("确定")])],1)],1)],1)},staticRenderFns:[]};var d=a("C7Lr")(n,u,!1,function(e){a("K9OU")},null,null);t.default=d.exports},K9OU:function(e,t){},ZYTe:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("//Fk"),s=a.n(r),l=a("P9l9"),i=a("Lna1"),o=a("2D9T"),c=a("5ewr"),n=a("Fv1n"),u={name:"cloth",data:function(){return{lodingStatus:!1,isRedact:!1,orderStatus:"",factory:[],workshop:[],productline:[],formHeader:{factory:"",workShop:"",productLine:"",productDate:"",upMan:"",upDate:"",clickstatus:"saved"},activeName:"1",succmessage:"保存成功",contentshow:!1}},mounted:function(){Object(i.f)(this.$),this.Getdeptcode()},watch:{"formHeader.factory":function(e,t){this.Getdeptbyid(e)},"formHeader.workShop":function(e,t){this.GetParentline(e)},"formHeader.productDate":function(e,t){this.contentshow=!1,this.isRedact=!1}},methods:{Getdeptcode:function(){var e=this;this.$http(l.c.FINDORG_API+"?code=factory","POST").then(function(t){var a=t.data;0===a.code?e.factory=a.typeList:e.$message.error(a.msg)})},Getdeptbyid:function(e){var t=this;this.formHeader.workShop="",this.formHeader.productLine="",this.contentshow=!1,this.isRedact=!1,e?this.$http(""+l.c.FINDORGBYID_API,"POST",{deptId:e,deptName:"压榨"}).then(function(e){var a=e.data;0===a.code?t.workshop=a.typeList:t.$message.error(a.msg)}):this.workshop=[]},GetParentline:function(e){var t=this;this.formHeader.productLine="",this.contentshow=!1,this.isRedact=!1,e?this.$http(""+l.c.FINDORGBYPARENTID1_API,"POST",{parentId:e,deptType:"proLine"}).then(function(e){var a=e.data;0===a.code?t.productline=a.childList:t.$message.error(a.msg)}):this.productline=[]},SearchList:function(){return this.formHeader.factory&&""!==this.formHeader.factory?this.formHeader.workShop&&""!==this.formHeader.workShop?this.formHeader.productLine&&""!==this.formHeader.productLine?this.formHeader.productDate&&""!==this.formHeader.productDate?(this.contentshow=!0,this.$refs.material.GetMateriaList(this.formHeader),this.$refs.excrecord.GetequipmentType(this.formHeader.productLine),this.$refs.excrecord.GetExcDate({factory:this.formHeader.factory,workShop:this.formHeader.workShop,productLine:this.formHeader.productLine,productDate:this.formHeader.productDate}),void this.$refs.textrecord.GetText({factory:this.formHeader.factory,workShop:this.formHeader.workShop,productLine:this.formHeader.productLine,productDate:this.formHeader.productDate})):(this.$message.error("请选择生产日期"),!1):(this.$message.error("请选择布浆线"),!1):(this.$message.error("请选择生产车间"),!1):(this.$message.error("请选择生产工厂"),!1)},SubmitForm:function(){var e=this;this.$confirm("确认提交该订单, 是否继续?","提交订单",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.savedOrSubmitForm("submit")})},savedOrSubmitForm:function(e){if("submit"===e){if(this.$set(this.formHeader,"clickstatus","submit"),!this.$refs.material.Readyrules())return!1;this.succmessage="提交成功"}else this.$set(this.formHeader,"clickstatus","saved");var t=this,a=new s.a(function(e,a){t.$refs.excrecord.saveOrSubmitExc(t.formHeader,"Squeeze",e,a)}),r=new s.a(function(e,a){t.$refs.textrecord.UpdateText(t.formHeader,"Squeeze",e,a)});new s.a(function(e,a){t.$refs.material.savemain(e,a)}).then(function(){var e=new s.a(function(e,a){t.$refs.material.savesecond(e,a)}),l=new s.a(function(e,a){t.$refs.material.savepeople(e,a)});s.a.all([e,l,a,r]).then(function(){t.$message.success(t.succmessage),t.SearchList(),t.isRedact=!1}).catch(function(){t.$message.error("网络请求失败，请刷新重试")})})},tabClick:function(e){this.$refs.tabs.setCurrentName(e.name)},setApplyMaterielState:function(e){this.orderStatus=e,this.$refs.tabs.handleTabClick(this.$refs.tabs.panes[parseInt(this.$refs.tabs.currentName)-1])}},components:{Material:o.default,ExcRecord:c.default,TextRecord:n.default}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.lodingStatus,expression:"lodingStatus",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"main",attrs:{"element-loading-text":"加载中"}},[a("el-card",{staticClass:"newCard searchCard"},[a("el-row",[a("el-col",[a("el-form",{attrs:{model:e.formHeader,inline:!0,size:"small","label-width":"75px"}},[a("el-form-item",{attrs:{label:"生产工厂："}},[a("el-select",{staticClass:"width180px",attrs:{placeholder:"请选择"},model:{value:e.formHeader.factory,callback:function(t){e.$set(e.formHeader,"factory",t)},expression:"formHeader.factory"}},[a("el-option",{attrs:{label:"请选择",value:""}}),e._v(" "),e._l(e.factory,function(e,t){return a("el-option",{key:t,attrs:{label:e.deptName,value:e.deptId}})})],2)],1),e._v(" "),a("el-form-item",{attrs:{label:"生产车间："}},[a("el-select",{staticClass:"width180px",attrs:{placeholder:"请选择"},model:{value:e.formHeader.workShop,callback:function(t){e.$set(e.formHeader,"workShop",t)},expression:"formHeader.workShop"}},[a("el-option",{attrs:{label:"请选择",value:""}}),e._v(" "),e._l(e.workshop,function(e,t){return a("el-option",{key:t,attrs:{label:e.deptName,value:e.deptId}})})],2)],1),e._v(" "),a("el-form-item",{attrs:{label:"布浆线："}},[a("el-select",{staticClass:"width180px",attrs:{placeholder:"请选择"},model:{value:e.formHeader.productLine,callback:function(t){e.$set(e.formHeader,"productLine",t)},expression:"formHeader.productLine"}},[a("el-option",{attrs:{label:"请选择",value:""}}),e._v(" "),e._l(e.productline,function(e,t){return a("el-option",{key:t,attrs:{label:e.deptName,value:e.deptId}})})],2)],1),e._v(" "),a("el-form-item",{attrs:{label:"生产日期："}},[a("el-date-picker",{staticClass:"width180px",attrs:{type:"date",placeholder:"选择日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:e.formHeader.productDate,callback:function(t){e.$set(e.formHeader,"productDate",t)},expression:"formHeader.productDate"}})],1)],1)],1)],1),e._v(" "),a("el-row",{staticStyle:{"text-align":"right"}},[[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.SearchList}},[e._v("查询")]),e._v(" "),"submit"!==e.orderStatus&&"checked"!==e.orderStatus?a("el-button",{staticClass:"button",attrs:{type:"primary",size:"small"},on:{click:function(t){e.isRedact=!e.isRedact}}},[e._v(e._s(e.isRedact?"取消":"编辑"))]):e._e()],e._v(" "),e.isRedact?[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.savedOrSubmitForm("saved")}}},[e._v("保存")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.SubmitForm}},[e._v("提交")])]:e._e()],2),e._v(" "),a("div",{staticClass:"toggleSearchBottom"},[a("i",{staticClass:"el-icon-caret-top"})])],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.contentshow,expression:"contentshow"}],staticClass:"tableCard"},[e._m(0),e._v(" "),a("el-tabs",{ref:"tabs",staticClass:"NewDaatTtabs",staticStyle:{"margin-top":"15px"},attrs:{id:"DaatTtabs",type:"border-card"},on:{"tab-click":e.tabClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{name:"1",label:"物料领用"}},[a("Material",{ref:"material",attrs:{isRedact:e.isRedact,formHeader:e.formHeader},on:{setApplyMaterielState:e.setApplyMaterielState}})],1),e._v(" "),a("el-tab-pane",{attrs:{name:"2",label:"异常记录"}},[a("exc-record",{ref:"excrecord",attrs:{isRedact:e.isRedact}})],1),e._v(" "),a("el-tab-pane",{attrs:{name:"3",label:"文本记录"}},[a("text-record",{ref:"textrecord",attrs:{isRedact:e.isRedact}})],1)],1)],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"toggleSearchTop",staticStyle:{"background-color":"white","margin-bottom":"8px",position:"relative","border-radius":"5px"}},[t("i",{staticClass:"el-icon-caret-bottom"})])}]};var p=a("C7Lr")(u,d,!1,function(e){a("qD5E")},"data-v-09ce5bf6",null);t.default=p.exports},qD5E:function(e,t){}});
//# sourceMappingURL=31.03b34691bd93e1e383e4.js.map