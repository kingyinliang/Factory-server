webpackJsonp([26,100],{"7Le0":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("mvHQ"),r=a.n(i),l=a("P9l9"),s={name:"CapacityManage",data:function(){return{loginstatus:!1,visible:!1,capacity:{capacity:""},SerchSapList:[],deptId:"",OrgTree:[],CapacityList:[],arrList:[],multipleSelection:[],totalCount:1,currPage:1,pageSize:10}},mounted:function(){var t=this;this.getTree(),this.$http(""+l.c.FINDSAP_API,"POST",{params:""},!1,!1,!1).then(function(e){var a=e.data;0===a.code?t.SerchSapList=a.list:t.$message.error(a.msg)})},methods:{getTree:function(){var t=this;this.$http(""+l.c.ORGSTRUCTURE_API,"GET",{}).then(function(e){var a=e.data;0===a.code?(t.OrgTree=a.deptList,t.arrList=[t.OrgTree[0].children[0].deptId]):t.$message.error(a.msg)})},GetList:function(t,e){var a=this;this.loginstatus=!0,t&&(this.deptId=t.deptId),e&&(this.currPage=1),this.$http(""+l.c.CAPALIST_API,"POST",{deptId:this.deptId,materialCode:this.capacity.capacity,currPage:r()(this.currPage),pageSize:r()(this.pageSize)}).then(function(t){var e=t.data;0===e.code?(a.multipleSelection=[],a.CapacityList=e.page.list,a.currPage=e.page.currPage,a.pageSize=e.page.pageSize,a.totalCount=e.page.totalCount):a.$message.error(e.msg),a.visible=!1,a.loginstatus=!1})},handleSelectionChange:function(t){var e=this;this.multipleSelection=[],t.forEach(function(t,a){e.multipleSelection.push(t.id)})},addOrupdate:function(t){var e=this;this.deptId?(this.visible=!0,this.$nextTick(function(){e.$refs.capaaddupdate.init(e.deptId,t)})):this.$message.error("请先选择部门")},remove:function(){var t=this;0===this.multipleSelection.length?this.$message.error("请选择要删除的产能"):this.$confirm("确认删除该物料产能, 是否继续?","删除产能",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http(""+l.c.CAPADEL_API,"POST",t.multipleSelection).then(function(e){var a=e.data;console.log(a),0===a.code?(t.$message({type:"success",message:"删除成功!"}),t.multipleSelection=[],t.GetList()):t.$message.error(a.msg)})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},indexMethod:function(t){return t+1+(1*this.currPage-1)*(1*this.pageSize)},handleSizeChange:function(t){this.pageSize=t,this.GetList()},handleCurrentChange:function(t){this.currPage=t,this.GetList()}},computed:{},components:{CapacityAddOrUpdate:a("wTnO").default}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-col",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.loginstatus,expression:"loginstatus",modifiers:{fullscreen:!0,lock:!0}}],attrs:{"element-loading-text":"加载中"}},[a("div",{staticClass:"main"},[a("el-card",[a("el-row",{staticClass:"clearfix"},[a("div",{staticStyle:{float:"right"}},[a("el-form",{staticClass:"topforms2",attrs:{inline:!0,model:t.capacity,size:"small","label-width":"68px"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.GetList()}}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"物料","suffix-icon":"el-icon-search"},model:{value:t.capacity.capacity,callback:function(e){t.$set(t.capacity,"capacity",e)},expression:"capacity.capacity"}})],1),t._v(" "),a("el-form-item",[t.isAuth("sys:capacity:listCapa")?a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.GetList(!1,!0)}}},[t._v("查询")]):t._e()],1)],1)],1)]),t._v(" "),a("el-row",{attrs:{type:"flex",gutter:20}},[a("el-col",{attrs:{span:8}},[a("el-card",[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("组织架构")])]),t._v(" "),a("el-tree",{attrs:{data:t.OrgTree,"node-key":"deptId","default-expanded-keys":t.arrList,"expand-on-click-node":!1},on:{"node-click":t.GetList}})],1)],1),t._v(" "),t.isAuth("sys:capacity:listCapa")?a("el-col",{attrs:{span:16}},[a("el-card",[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("产能信息")])]),t._v(" "),a("div",[t.isAuth("sys:capacity:deleteCapa")?a("el-button",{staticStyle:{float:"right",margin:"0 20px 20px 0"},attrs:{type:"danger",size:"small"},on:{click:function(e){return t.remove()}}},[t._v("批量删除")]):t._e(),t._v(" "),t.isAuth("sys:capacity:saveOrUpdateCapa")?a("el-button",{staticStyle:{float:"right",margin:"0 20px 20px 0"},attrs:{type:"primary",size:"small"},on:{click:function(e){return t.addOrupdate()}}},[t._v("增加")]):t._e()],1),t._v(" "),a("el-table",{ref:"table1",staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{data:t.CapacityList,"header-row-class-name":"tableHead",border:"","tooltip-effect":"dark"},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"34"}}),t._v(" "),a("el-table-column",{attrs:{type:"index",label:"序号",index:t.indexMethod,width:"55"}}),t._v(" "),a("el-table-column",{attrs:{prop:"workNum","show-overflow-tooltip":!0,label:"物料"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                  "+t._s(e.row.materialCode+" "+e.row.materialName)+"\n                ")]}}],null,!1,2762302903)}),t._v(" "),a("el-table-column",{attrs:{prop:"basicCapacity",label:"标准产能","show-overflow-tooltip":!0,width:"87"}}),t._v(" "),a("el-table-column",{attrs:{prop:"basicCapacityUnitName",label:"单位",width:"50","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{prop:"standardOfMan",label:"标配人力",width:"80","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{prop:"changer",label:"操作人",width:"87","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{prop:"changed",label:"操作时间",width:"120","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.isAuth("sys:capacity:saveOrUpdateCapa")?a("el-button",{staticStyle:{padding:"0"},attrs:{type:"text"},on:{click:function(a){return t.addOrupdate(e.row)}}},[t._v("编辑")]):t._e()]}}],null,!1,710922592)})],1),t._v(" "),a("el-row",[a("el-pagination",{attrs:{"current-page":t.currPage,"page-sizes":[10,15,20],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.totalCount},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)],1):t._e()],1)],1)],1),t._v(" "),t.visible?a("capacity-add-or-update",{ref:"capaaddupdate",attrs:{SerchSapList:t.SerchSapList},on:{refreshDataList:t.GetList}}):t._e()],1)},staticRenderFns:[]};var o=a("C7Lr")(s,n,!1,function(t){a("9bEY")},"data-v-b44136f6",null);e.default=o.exports},"9bEY":function(t,e){},ci6j:function(t,e){},wTnO:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("mvHQ"),r=a.n(i),l=a("P9l9"),s={name:"CapacityAddOrUpdate",data:function(){return{Unit:[],CapacityId:"",deptId:"",visible:!1,dataForm:{material:"",standardOfMan:"",basicCapacity:0,basicCapacityUnit:"",changer:"",changed:""},dataRule:{material:[{required:!0,message:"物料不能为空",trigger:"blur"}],basicCapacity:[{required:!0,message:"产能不能为空",trigger:"blur"}],standardOfMan:[{required:!0,message:"标配人力不能为空",trigger:"blur"}],basicCapacityUnit:[{required:!0,message:"单位不能为空",trigger:"blur"}]}}},props:{SerchSapList:{}},mounted:function(){this.GetUnit()},methods:{GetUnit:function(){var t=this;this.$http(l.k.PARAMETERLIST_API+"?type=UNIT","POST").then(function(e){var a=e.data;0===a.code?t.Unit=a.dicList:t.$message.error(a.msg)})},init:function(t,e){this.deptId=t,e?(this.CapacityId=e.id,this.dataForm=JSON.parse(r()(e)),this.dataForm.material=e.materialCode+" "+e.materialName):(this.CapacityId="",this.dataForm={},this.dataForm.deptId=t),this.visible=!0},dataFormSubmit:function(){var t=this;this.$refs.dataForm.validate(function(e){e&&(t.dataForm.materialCode=t.dataForm.material.substring(0,t.dataForm.material.indexOf(" ")),t.dataForm.materialName=t.dataForm.material.substring(t.dataForm.material.indexOf(" ")+1),t.$http(""+l.c.CAPAADDORUPDATE_API,"POST",t.dataForm).then(function(e){var a=e.data;0===a.code?t.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){t.visible=!1,t.$emit("refreshDataList")}}):(t.submitType=!0,t.$message.error(a.msg))}))})}},computed:{},components:{}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:t.CapacityId?"修改产能信息":"新增产能","close-on-click-modal":!1,visible:t.visible},on:{"update:visible":function(e){t.visible=e}}},[a("div",[a("el-form",{ref:"dataForm",attrs:{model:t.dataForm,"status-icon":"",rules:t.dataRule,"label-width":"100px"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.dataFormSubmit()}}},[a("el-form-item",{attrs:{label:"物料：",prop:"material"}},[t.CapacityId?a("el-select",{attrs:{filterable:"",placeholder:"请选择",disabled:""},model:{value:t.dataForm.material,callback:function(e){t.$set(t.dataForm,"material",e)},expression:"dataForm.material"}},t._l(t.SerchSapList,function(t){return a("el-option",{key:t.sapCode+" "+t.itemName,attrs:{label:t.sapCode+" "+t.itemName,value:t.sapCode+" "+t.itemName}})}),1):a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:t.dataForm.material,callback:function(e){t.$set(t.dataForm,"material",e)},expression:"dataForm.material"}},t._l(t.SerchSapList,function(t){return a("el-option",{key:t.sapCode+" "+t.itemName,attrs:{label:t.sapCode+" "+t.itemName,value:t.sapCode+" "+t.itemName}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"标准产能：",prop:"basicCapacity"}},[a("el-input",{attrs:{placeholder:"手动输入"},model:{value:t.dataForm.basicCapacity,callback:function(e){t.$set(t.dataForm,"basicCapacity",e)},expression:"dataForm.basicCapacity"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"单位：",prop:"basicCapacityUnit"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:t.dataForm.basicCapacityUnit,callback:function(e){t.$set(t.dataForm,"basicCapacityUnit",e)},expression:"dataForm.basicCapacityUnit"}},t._l(t.Unit,function(t){return a("el-option",{key:t.code,attrs:{label:t.value,value:t.code}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"标配人力：",prop:"standardOfMan"}},[a("el-input",{attrs:{placeholder:"手动输入"},model:{value:t.dataForm.standardOfMan,callback:function(e){t.$set(t.dataForm,"standardOfMan",e)},expression:"dataForm.standardOfMan"}})],1),t._v(" "),t.CapacityId?a("el-form-item",{attrs:{label:"维护人："}},[a("el-input",{attrs:{placeholder:"手动输入",disabled:""},model:{value:t.dataForm.changer,callback:function(e){t.$set(t.dataForm,"changer",e)},expression:"dataForm.changer"}})],1):t._e(),t._v(" "),t.CapacityId?a("el-form-item",{attrs:{label:"维护时间："}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"选择",disabled:""},model:{value:t.dataForm.changed,callback:function(e){t.$set(t.dataForm,"changed",e)},expression:"dataForm.changed"}})],1):t._e()],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.visible=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.dataFormSubmit}},[t._v("确定")])],1)])},staticRenderFns:[]};var o=a("C7Lr")(s,n,!1,function(t){a("ci6j")},"data-v-54e7bbea",null);e.default=o.exports}});
//# sourceMappingURL=26.bfb5392f1e1cbffc9cfe.js.map