webpackJsonp([36],{EdR0:function(t,e){},xydm:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("P9l9"),i=a("Lna1"),s={name:"index",data:function(){return{factory:[],workshop:[],productline:[],plantList:{status:"checked",orderNo:"",factory:"",workshop:"",productline:"",productdate:"",currPage:1,pageSize:10,totalCount:0},MaintainList:[],noMaintainList:[]}},watch:{"plantList.factory":function(t,e){this.Getdeptbyid(t)},"plantList.workshop":function(t,e){t&&this.GetParentline(t)}},mounted:function(){this.Getdeptcode(),Object(i.f)(this.$)},methods:{GetMaintainList:function(t){var e=this;t&&(this.plantList.currPage=1),this.$http(""+n.f.MAINTAINLIST_API,"POST",this.plantList).then(function(t){var a=t.data;0===a.code?(e.noMaintainList=a.page.list,e.plantList.currPage=a.page.currPage,e.plantList.pageSize=a.page.pageSize,e.plantList.totalCount=a.page.totalCount):e.$message.error(a.msg)})},Getdeptcode:function(){var t=this;this.$http(n.c.FINDORG_API+"?code=factory","POST").then(function(e){var a=e.data;0===a.code?t.factory=a.typeList:t.$message.error(a.msg)})},Getdeptbyid:function(t){var e=this;this.plantList.workshop="",this.plantList.productline="",t&&this.$http(""+n.c.FINDORGBYID_API,"POST",{deptId:t,deptName:"包装 组装"}).then(function(t){var a=t.data;0===a.code?e.workshop=a.typeList:e.$message.error(a.msg)})},GetParentline:function(t){var e=this;this.plantList.productline="",t&&this.$http(""+n.c.FINDORGBYPARENTID_API,"POST",{parentId:t}).then(function(t){var a=t.data;0===a.code?e.productline=a.childList:e.$message.error(a.msg)})},handleSelectionChange:function(t){var e=this;this.MaintainList=[],t.forEach(function(t,a){e.MaintainList.push(t)})},checkboxT:function(t){return"finished"===t.status||0===t.aiShelves?0:1},getverify:function(){var t=!0;return this.MaintainList.forEach(function(e){(0!==e.different||e.orgnDifferent)&&(e.differentInfo||(t=!1))}),t},getverify1:function(){var t=!0;return this.MaintainList.forEach(function(e){1*e.aiShelves!=1*e.jwzAcount&&(t=!1)}),t},redact:function(t){var e=this;if(t.redact){if((0!==t.different||t.orgnDifferent)&&!t.differentInfo)return this.$message.error("差异说明必填"),!1;t.postgDate=this.plantList.postgDate,t.status="",this.$http(""+n.f.MAINTAINSAVE_API,"POST",[t]).then(function(a){var n=a.data;0===n.code?(e.$message.success("操作成功"),t.redact=!1,e.noMaintainList.splice(e.noMaintainList.length,0,{}),e.noMaintainList.splice(e.noMaintainList.length-1,1)):e.$message.error(n.msg)})}else t.redact=!0,this.noMaintainList.splice(this.noMaintainList.length,0,{}),this.noMaintainList.splice(this.noMaintainList.length-1,1)},save:function(){var t=this;if(this.MaintainList.length>0){if(!this.getverify())return this.$message.error("差异说明必填"),!1;this.$confirm("确认保存, 是否继续?","保存",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http(""+n.f.MAINTAINSAVE_API,"POST",t.MaintainList).then(function(e){var a=e.data;0===a.code?(t.$message.success("保存成功"),t.GetMaintainList()):t.$message.error(a.msg)}),t.GetMaintainList()})}else this.$message.error("请勾选后保存")},submit:function(){var t=this;if(this.MaintainList.length>0){if(!this.getverify())return this.$message.error("差异说明必填"),!1;if(!this.getverify1())return this.$message.error("车间入库数与机维组确认数不一致，请重新录入数据！"),!1;this.$confirm("确认提交, 是否继续?","提交",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http(""+n.f.MAINTAINSUB_API,"POST",t.MaintainList).then(function(e){var a=e.data;0===a.code?(t.$message.success("提交成功"),t.GetMaintainList()):t.$message.error(a.msg)})})}else this.$message.error("请勾选后保存")},handleSizeChange:function(t){this.plantList.pageSize=t,this.GetMaintainList()},handleCurrentChange:function(t){this.plantList.currPage=t,this.GetMaintainList()}},computed:{},components:{}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-col",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.lodingStatus,expression:"lodingStatus",modifiers:{fullscreen:!0,lock:!0}}],attrs:{"element-loading-text":"加载中"}},[a("div",{staticClass:"main"},[a("el-card",{staticClass:"searchCard"},[a("el-row",{attrs:{type:"flex"}},[a("el-col",[a("el-form",{staticClass:"maintain",attrs:{model:t.plantList,size:"small",inline:!0,"label-position":"right","label-width":"70px"}},[a("el-form-item",{attrs:{label:"工厂："}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.plantList.factory,callback:function(e){t.$set(t.plantList,"factory",e)},expression:"plantList.factory"}},[a("el-option",{attrs:{label:"请选择",value:""}}),t._v(" "),t._l(t.factory,function(t,e){return a("el-option",{key:e,attrs:{label:t.deptName,value:t.deptId}})})],2)],1),t._v(" "),a("el-form-item",{attrs:{label:"车间："}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.plantList.workshop,callback:function(e){t.$set(t.plantList,"workshop",e)},expression:"plantList.workshop"}},[a("el-option",{attrs:{label:"请选择",value:""}}),t._v(" "),t._l(t.workshop,function(t,e){return a("el-option",{key:e,attrs:{label:t.deptName,value:t.deptId}})})],2)],1),t._v(" "),a("el-form-item",{attrs:{label:"产线："}},[a("el-select",{attrs:{placeholder:"产线"},model:{value:t.plantList.productline,callback:function(e){t.$set(t.plantList,"productline",e)},expression:"plantList.productline"}},[a("el-option",{attrs:{label:"请选择",value:""}}),t._v(" "),t._l(t.productline,function(t,e){return a("el-option",{key:e,attrs:{label:t.deptName,value:t.deptId}})})],2)],1),t._v(" "),a("el-form-item",{attrs:{label:"订单号："}},[a("el-input",{attrs:{placeholder:"订单号"},model:{value:t.plantList.orderNo,callback:function(e){t.$set(t.plantList,"orderNo",e)},expression:"plantList.orderNo"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"日期："}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.plantList.productdate,callback:function(e){t.$set(t.plantList,"productdate",e)},expression:"plantList.productdate"}})],1)],1)],1),t._v(" "),a("el-col",{staticStyle:{width:"260px"}},[a("el-row",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.GetMaintainList(!0)}}},[t._v("查询")]),t._v(" "),t.isAuth("sys:verifyJWZ:update")?a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.save()}}},[t._v("保存")]):t._e(),t._v(" "),t.isAuth("sys:verifyJWZ:finished")?a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.submit()}}},[t._v("提交")]):t._e()],1)],1)],1),t._v(" "),a("div",{staticClass:"toggleSearchBottom"},[a("i",{staticClass:"el-icon-caret-top"})])],1)],1),t._v(" "),a("div",{staticClass:"main",staticStyle:{"padding-top":"0"}},[a("el-card",{staticClass:"tableCard"},[a("div",{staticClass:"toggleSearchTop"},[a("i",{staticClass:"el-icon-caret-bottom"})]),t._v(" "),a("el-table",{ref:"maintain",staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{"header-row-class-name":"tableHead",data:t.noMaintainList,border:"","tooltip-effect":"dark"},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",selectable:t.checkboxT,width:"34"}}),t._v(" "),a("el-table-column",{attrs:{type:"index",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{prop:"orderNo",label:"生产订单号","show-overflow-tooltip":!0,width:"120"}}),t._v(" "),a("el-table-column",{attrs:{label:"品项","show-overflow-tooltip":!0,width:"360"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\r\n            "+t._s(e.row.materialCode+" "+e.row.materialName)+"\r\n          ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"batch",label:"生产批次",width:"105"}}),t._v(" "),a("el-table-column",{attrs:{prop:"aiShelves",label:"自动上架数-立体库",width:"140"}}),t._v(" "),a("el-table-column",{attrs:{prop:"aiShelvesUnitName",label:"单位",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{label:"车间确认人","show-overflow-tooltip":!0,width:"92"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.workShopMan))]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"机维组确认整板数",width:"135"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.redact?a("el-input",{model:{value:e.row.jwzZb,callback:function(a){t.$set(e.row,"jwzZb",a)},expression:"scope.row.jwzZb"}}):t._e(),t._v(" "),e.row.redact?t._e():a("span",[t._v(t._s(e.row.jwzZb))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"机维组确认半板数",width:"135"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.redact?a("el-input",{model:{value:e.row.jwzBb,callback:function(a){t.$set(e.row,"jwzBb",a)},expression:"scope.row.jwzBb"}}):t._e(),t._v(" "),e.row.redact?t._e():a("span",[t._v(t._s(e.row.jwzBb))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"机维组确认数",width:"107"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.jwzAcount=1*e.row.jwzBb+1*e.row.jwzZb))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"差异数量",width:"78"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.different=1*e.row.jwzAcount-1*e.row.aiShelves))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"单位",width:"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.differentUnitName))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"原差异数量",width:"92"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.redact?a("el-input",{model:{value:e.row.orgnDifferent,callback:function(a){t.$set(e.row,"orgnDifferent",a)},expression:"scope.row.orgnDifferent"}}):a("span",[t._v(t._s(e.row.orgnDifferent))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"差异说明","show-overflow-tooltip":!0,width:"78"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.redact?a("el-input",{model:{value:e.row.differentInfo,callback:function(a){t.$set(e.row,"differentInfo",a)},expression:"scope.row.differentInfo"}}):a("span",[t._v(t._s(e.row.differentInfo))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"jwzMan",label:"机维组确认人",width:"107"}}),t._v(" "),a("el-table-column",{attrs:{label:"备注","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.remark))])]}}])}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",prop:"address",label:"操作",width:"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.isAuth("sys:verifyJWZ:update")&&"finished"!==e.row.status&&0!==e.row.aiShelves?a("el-button",{staticStyle:{padding:"0"},attrs:{type:"text",size:"small"},on:{click:function(a){return t.redact(e.row)}}},[t._v(t._s(e.row.redact?"保存":"编辑"))]):t._e()]}}])})],1),t._v(" "),a("el-row",[a("el-pagination",{attrs:{"current-page":t.plantList.currPage,"page-sizes":[10,15,20],"page-size":t.plantList.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.plantList.totalCount},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)],1)])},staticRenderFns:[]};var r=a("C7Lr")(s,o,!1,function(t){a("EdR0"),a("z1JG")},"data-v-9d2913c8",null);e.default=r.exports},z1JG:function(t,e){}});
//# sourceMappingURL=36.86b771aa1670d7cdea9d.js.map