webpackJsonp([85],{"7xD5":function(t,e){},lhs2:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("P9l9"),o={name:"listBom",data:function(){return{Sapstatus:"",finHolder:[],semiHolder:[],listbomP:[],listbomS:[],SapAudit:[]}},props:{isRedact:{},order:{}},mounted:function(){},methods:{GetpkgSap:function(t,e){var s=this;e?(this.listbomP=e.listbomP,this.listbomS=e.listbomS,this.listbomS.forEach(function(t){t.isSplit="0",t.delFlag="0",t.id="",t.orderId=e.list[0].orderId}),this.listbomP.forEach(function(t){t.id="",t.orderId=e.list[0].orderId})):this.$http(""+a.h.PKGSPALIST_API,"POST",{order_id:t.orderId,factory:t.factory}).then(function(t){var e=t.data;if(0===e.code){s.listbomP=e.listFormP,s.listbomS=e.listFormS,s.SapAudit=e.listApproval;var a=0,o=0,l=0,r=0;s.listbomP.forEach(function(t){"noPass"===t.status?l+=1:"submit"===t.status?a+=1:"checked"===t.status?o+=1:"saved"===t.status&&(r+=1)}),s.listbomS.forEach(function(t){"noPass"===t.status?l+=1:"submit"===t.status?a+=1:"checked"===t.status?o+=1:"saved"===t.status&&(r+=1)}),l>0?s.Sapstatus="noPass":r>0?s.Sapstatus="saved":a>0?s.Sapstatus="submit":o>0&&(s.Sapstatus="checked"),s.$emit("GetlistbomStatus",s.Sapstatus)}else s.$message.error(e.msg)})},UpdateSap:function(t,e){var s=this;this.listbomP.forEach(function(e){e.status?"saved"===e.status?e.status=t:"noPass"===e.status&&"submit"===t&&(e.status=t):e.status=t}),this.listbomS.forEach(function(e){e.status?"saved"===e.status?e.status=t:"noPass"===e.status&&"submit"===t&&(e.status=t):e.status=t}),this.$http(""+a.h.PKGSPAUPDATEP_API,"POST",this.listbomP).then(function(t){var o=t.data;s.$http(""+a.h.PKGSPAUPDATES_API,"POST",s.listbomS).then(function(t){var a=t.data;e&&e("resolve"),0===a.code||s.$message.error("物料领用"+a.msg)}),0===o.code||s.$message.error("物料领用"+o.msg)})},subSap:function(t){var e=this;this.$http(""+a.h.PKGSAVEFORMP_API,"POST",this.listbomP).then(function(s){var o=s.data;0===o.code||e.$message.error(o.msg),e.$http(""+a.h.PKGSAVEFORMS_API,"POST",e.listbomS).then(function(s){var a=s.data;0===a.code||e.$message.error(a.msg),t&&t("resolve")})})},saprul:function(t){for(var e=this,s=!0,a=0;a<this.listbomS.length-1;a++)for(var o=a+1;o<this.listbomS.length;o++)if("1"!==this.listbomS[a].delFlag&&"1"!==this.listbomS[o].delFlag&&""!==this.listbomS[a].potNo&&""!==this.listbomS[a].batch&&""!==this.listbomS[o].potNo&&""!==this.listbomS[o].batch&&this.listbomS[a].materialCode===this.listbomS[o].materialCode&&this.listbomS[a].potNo===this.listbomS[o].potNo&&this.listbomS[a].batch===this.listbomS[o].batch)return s=!1,this.$message.error("存在重复批次，请核实"),!1;return"submit"===t&&(this.listbomP.forEach(function(t){if("1"!==t.delFlag&&0!==t.productUseNum&&!t.productUseNum)return s=!1,e.$message.error("物料必填项未填"),!1}),"二合一&礼盒产线"!==this.order.properties&&this.listbomS.forEach(function(t,a){if("1"!==t.delFlag&&!(t.potNo&&t.filterDate&&t.productUseNum&&t.batch))return s=!1,e.$message.error("物料半成品必填项未填"),!1})),s},GetPot:function(t){var e=this;this.$http(""+a.c.CONTAINERLIST_API,"POST",{factory:t,type:"holder_type",holder_type:"007",pageSize:9999,workShopName:this.order.workShopName,currPage:1}).then(function(t){var s=t.data;0===s.code?e.finHolder=s.page.list:e.$message.error(s.msg)}),this.$http(""+a.c.CONTAINERLIST_API,"POST",{factory:t,type:"holder_type",holder_type:"006",pageSize:9999,workShopName:this.order.workShopName,currPage:1}).then(function(t){var s=t.data;0===s.code?e.semiHolder=s.page.list:e.$message.error(s.msg)})},dellistbomS:function(t,e){t.delFlag="1"},addSapS:function(t,e){t.push({batch:"",orderId:this.order.orderId,status:"",id:"",materialCode:e.materialCode,materialName:e.materialName,unit:e.unit,potNo:"",filterDate:null,productUseNum:"",changePotDate:null,usePotDate:null,isSplit:"1",delFlag:"0"})},tableRowClassName:function(t){var e=t.row;t.rowIndex;return"1"===e.delFlag?"warning-row":""},RowDelFlag:function(t){var e=t.row;t.rowIndex;return"1"===e.delFlag?"rowDel":""}},computed:{},components:{AuditLog:function(t){s.e(1).then(function(){var e=[s("bpq2")];t.apply(null,e)}.bind(this)).catch(s.oe)}}},l={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("el-table",{ref:"table1",staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{"row-class-name":t.tableRowClassName,"header-row-class-name":"tableHead",data:t.listbomP,border:"","tooltip-effect":"dark"}},[s("el-table-column",{attrs:{type:"index",width:"50",label:"序号"}}),t._v(" "),s("el-table-column",{attrs:{width:"240","show-overflow-tooltip":!0,label:"物料"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.materialCode+" "+e.row.materialName))]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"unit",label:"单位",width:"60"}}),t._v(" "),s("el-table-column",{attrs:{prop:"needNum",label:"需求用量",width:"90"}}),t._v(" "),s("el-table-column",{attrs:{label:"生产使用",width:"135"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",{staticClass:"required"},[s("i",{staticClass:"reqI"},[t._v("*")]),t._v(" "),!t.isRedact||"noPass"!==t.Sapstatus&&"saved"!==t.Sapstatus&&""!==t.Sapstatus||"submit"===e.row.status||"checked"===e.row.status?s("el-input",{attrs:{size:"small",placeholder:"手工录入",disabled:"",type:"number",min:"0"},model:{value:e.row.productUseNum,callback:function(s){t.$set(e.row,"productUseNum",s)},expression:"scope.row.productUseNum"}}):s("el-input",{attrs:{size:"small",placeholder:"手工录入",type:"number",min:"0"},model:{value:e.row.productUseNum,callback:function(s){t.$set(e.row,"productUseNum",s)},expression:"scope.row.productUseNum"}})],1)]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"本班损耗"},scopedSlots:t._u([{key:"default",fn:function(e){return[!t.isRedact||"noPass"!==t.Sapstatus&&"saved"!==t.Sapstatus&&""!==t.Sapstatus||"submit"===e.row.status||"checked"===e.row.status?s("el-input",{attrs:{size:"small",placeholder:"手工录入",disabled:"",type:"number",min:"0"},model:{value:e.row.classLoss,callback:function(s){t.$set(e.row,"classLoss",s)},expression:"scope.row.classLoss"}}):s("el-input",{attrs:{size:"small",placeholder:"手工录入",type:"number",min:"0"},model:{value:e.row.classLoss,callback:function(s){t.$set(e.row,"classLoss",s)},expression:"scope.row.classLoss"}})]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"不合格数"},scopedSlots:t._u([{key:"default",fn:function(e){return[!t.isRedact||"noPass"!==t.Sapstatus&&"saved"!==t.Sapstatus&&""!==t.Sapstatus||"submit"===e.row.status||"checked"===e.row.status?s("el-input",{attrs:{size:"small",placeholder:"手工录入",disabled:"",type:"number",min:"0"},model:{value:e.row.belowGradeNum,callback:function(s){t.$set(e.row,"belowGradeNum",s)},expression:"scope.row.belowGradeNum"}}):s("el-input",{attrs:{size:"small",placeholder:"手工录入",type:"number",min:"0"},model:{value:e.row.belowGradeNum,callback:function(s){t.$set(e.row,"belowGradeNum",s)},expression:"scope.row.belowGradeNum"}})]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"不良批次"},scopedSlots:t._u([{key:"default",fn:function(e){return[!t.isRedact||"noPass"!==t.Sapstatus&&"saved"!==t.Sapstatus&&""!==t.Sapstatus||"submit"===e.row.status||"checked"===e.row.status?s("el-input",{attrs:{size:"small",placeholder:"手工录入",disabled:""},model:{value:e.row.badBatch,callback:function(s){t.$set(e.row,"badBatch",s)},expression:"scope.row.badBatch"}}):s("el-input",{attrs:{size:"small",maxlength:"10",placeholder:"手工录入"},model:{value:e.row.badBatch,callback:function(s){t.$set(e.row,"badBatch",s)},expression:"scope.row.badBatch"}})]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"厂家"},scopedSlots:t._u([{key:"default",fn:function(e){return[!t.isRedact||"noPass"!==t.Sapstatus&&"saved"!==t.Sapstatus&&""!==t.Sapstatus||"submit"===e.row.status||"checked"===e.row.status?s("el-input",{attrs:{size:"small",placeholder:"手工录入",disabled:""},model:{value:e.row.factory,callback:function(s){t.$set(e.row,"factory",s)},expression:"scope.row.factory"}}):s("el-input",{attrs:{size:"small",placeholder:"手工录入"},model:{value:e.row.factory,callback:function(s){t.$set(e.row,"factory",s)},expression:"scope.row.factory"}})]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"批次","show-overflow-tooltip":!0,width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(e.row.batch))])]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"备注"},scopedSlots:t._u([{key:"default",fn:function(e){return[!t.isRedact||"noPass"!==t.Sapstatus&&"saved"!==t.Sapstatus&&""!==t.Sapstatus||"submit"===e.row.status||"checked"===e.row.status?s("el-input",{attrs:{size:"small",disabled:""},model:{value:e.row.remark,callback:function(s){t.$set(e.row,"remark",s)},expression:"scope.row.remark"}}):s("el-input",{attrs:{size:"small"},model:{value:e.row.remark,callback:function(s){t.$set(e.row,"remark",s)},expression:"scope.row.remark"}})]}}])})],1),t._v(" "),"二合一&礼盒产线"!==t.order.properties?s("el-table",{ref:"table1",staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{"header-row-class-name":"tableHead",data:t.listbomS,"row-class-name":t.RowDelFlag,border:"","tooltip-effect":"dark"}},[s("el-table-column",{attrs:{type:"index",width:"50",label:"序号"}}),t._v(" "),s("el-table-column",{attrs:{width:"120",label:"物料（半成品）"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.materialCode+" "+e.row.materialName))]}}],null,!1,1477353815)}),t._v(" "),s("el-table-column",{attrs:{prop:"unit",label:"单位",width:"60"}}),t._v(" "),s("el-table-column",{attrs:{width:"150",label:"领用罐号"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",{staticClass:"required"},[s("i",{staticClass:"reqI"},[t._v("*")]),t._v(" "),!t.isRedact||"noPass"!==t.Sapstatus&&"saved"!==t.Sapstatus&&""!==t.Sapstatus||"submit"===e.row.status||"checked"===e.row.status?s("el-select",{attrs:{placeholder:"请选择",filterable:"",disabled:"",size:"small"},model:{value:e.row.potNo,callback:function(s){t.$set(e.row,"potNo",s)},expression:"scope.row.potNo"}},[t._l(t.finHolder,function(t){return s("el-option",{key:t.holderId,attrs:{label:t.holderName,value:t.holderName}})}),t._v(" "),t._l(t.semiHolder,function(t){return s("el-option",{key:t.holderId,attrs:{label:t.holderName,value:t.holderName}})})],2):s("el-select",{attrs:{placeholder:"请选择",filterable:"",size:"small"},model:{value:e.row.potNo,callback:function(s){t.$set(e.row,"potNo",s)},expression:"scope.row.potNo"}},[t._l(t.finHolder,function(t){return s("el-option",{key:t.holderId,attrs:{label:t.holderNo+t.typeName,value:t.holderNo+t.typeName}})}),t._v(" "),t._l(t.semiHolder,function(t){return s("el-option",{key:t.holderId,attrs:{label:t.holderNo+t.typeName,value:t.holderNo+t.typeName}})})],2)],1)]}}],null,!1,2468057643)}),t._v(" "),s("el-table-column",{attrs:{width:"250",label:"过滤日期"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",{staticClass:"required"},[s("i",{staticClass:"reqI"},[t._v("*")]),t._v(" "),!t.isRedact||"noPass"!==t.Sapstatus&&"saved"!==t.Sapstatus&&""!==t.Sapstatus||"submit"===e.row.status||"checked"===e.row.status?s("el-date-picker",{attrs:{size:"small",type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",format:"yyyy.MM.dd HH:mm",placeholder:"选择",disabled:""},model:{value:e.row.filterDate,callback:function(s){t.$set(e.row,"filterDate",s)},expression:"scope.row.filterDate"}}):s("el-date-picker",{attrs:{size:"small",type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",format:"yyyy.MM.dd HH:mm",placeholder:"选择"},model:{value:e.row.filterDate,callback:function(s){t.$set(e.row,"filterDate",s)},expression:"scope.row.filterDate"}})],1)]}}],null,!1,263699179)}),t._v(" "),s("el-table-column",{attrs:{width:"150",label:"批次"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",{staticClass:"required"},[s("i",{staticClass:"reqI"},[t._v("*")]),t._v(" "),!t.isRedact||"noPass"!==t.Sapstatus&&"saved"!==t.Sapstatus&&""!==t.Sapstatus||"submit"===e.row.status||"checked"===e.row.status?s("el-input",{attrs:{size:"small",disabled:""},model:{value:e.row.batch,callback:function(s){t.$set(e.row,"batch",s)},expression:"scope.row.batch"}}):s("el-input",{attrs:{size:"small",maxlength:"10"},model:{value:e.row.batch,callback:function(s){t.$set(e.row,"batch",s)},expression:"scope.row.batch"}})],1)]}}],null,!1,719802740)}),t._v(" "),s("el-table-column",{attrs:{width:"120",label:"生产使用量"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",{staticClass:"required"},[s("i",{staticClass:"reqI"},[t._v("*")]),t._v(" "),!t.isRedact||"noPass"!==t.Sapstatus&&"saved"!==t.Sapstatus&&""!==t.Sapstatus||"submit"===e.row.status||"checked"===e.row.status?s("el-input",{attrs:{size:"small",disabled:""},model:{value:e.row.productUseNum,callback:function(s){t.$set(e.row,"productUseNum",s)},expression:"scope.row.productUseNum"}}):s("el-input",{attrs:{size:"small"},model:{value:e.row.productUseNum,callback:function(s){t.$set(e.row,"productUseNum",s)},expression:"scope.row.productUseNum"}})],1)]}}],null,!1,2055171467)}),t._v(" "),s("el-table-column",{attrs:{width:"250",label:"换罐时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[!t.isRedact||"noPass"!==t.Sapstatus&&"saved"!==t.Sapstatus&&""!==t.Sapstatus||"submit"===e.row.status||"checked"===e.row.status?s("el-date-picker",{attrs:{type:"datetime",size:"small","value-format":"yyyy-MM-dd HH:mm:ss",format:"yyyy.MM.dd HH:mm",placeholder:"选择",disabled:""},model:{value:e.row.changePotDate,callback:function(s){t.$set(e.row,"changePotDate",s)},expression:"scope.row.changePotDate"}}):s("el-date-picker",{attrs:{type:"datetime",size:"small","value-format":"yyyy-MM-dd HH:mm:ss",format:"yyyy.MM.dd HH:mm",placeholder:"选择"},model:{value:e.row.changePotDate,callback:function(s){t.$set(e.row,"changePotDate",s)},expression:"scope.row.changePotDate"}})]}}],null,!1,873343624)}),t._v(" "),s("el-table-column",{attrs:{width:"250",label:"用完时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[!t.isRedact||"noPass"!==t.Sapstatus&&"saved"!==t.Sapstatus&&""!==t.Sapstatus||"submit"===e.row.status||"checked"===e.row.status?s("el-date-picker",{attrs:{type:"datetime",size:"small","value-format":"yyyy-MM-dd HH:mm:ss",format:"yyyy.MM.dd HH:mm",placeholder:"选择",disabled:""},model:{value:e.row.usePotDate,callback:function(s){t.$set(e.row,"usePotDate",s)},expression:"scope.row.usePotDate"}}):s("el-date-picker",{attrs:{type:"datetime",size:"small","value-format":"yyyy-MM-dd HH:mm:ss",format:"yyyy.MM.dd HH:mm",placeholder:"选择"},model:{value:e.row.usePotDate,callback:function(s){t.$set(e.row,"usePotDate",s)},expression:"scope.row.usePotDate"}})]}}],null,!1,3047160168)}),t._v(" "),s("el-table-column",{attrs:{label:"备注"},scopedSlots:t._u([{key:"default",fn:function(e){return[!t.isRedact||"noPass"!==t.Sapstatus&&"saved"!==t.Sapstatus&&""!==t.Sapstatus||"submit"===e.row.status||"checked"===e.row.status?s("el-input",{attrs:{size:"small",disabled:""},model:{value:e.row.remark,callback:function(s){t.$set(e.row,"remark",s)},expression:"scope.row.remark"}}):s("el-input",{attrs:{size:"small"},model:{value:e.row.remark,callback:function(s){t.$set(e.row,"remark",s)},expression:"scope.row.remark"}})]}}],null,!1,2641064296)}),t._v(" "),s("el-table-column",{attrs:{fixed:"right",label:"操作",width:"60"},scopedSlots:t._u([{key:"default",fn:function(e){return["0"!==e.row.isSplit||!t.isRedact||"noPass"!==t.Sapstatus&&"saved"!==t.Sapstatus&&""!==t.Sapstatus||"submit"===e.row.status||"checked"===e.row.status?t._e():s("el-button",{attrs:{type:"primary",icon:"el-icon-plus",circle:"",size:"small"},on:{click:function(s){return t.addSapS(t.listbomS,e.row)}}}),t._v(" "),"1"!==e.row.isSplit||!t.isRedact||"noPass"!==t.Sapstatus&&"saved"!==t.Sapstatus&&""!==t.Sapstatus?t._e():s("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:"",size:"small"},on:{click:function(s){return t.dellistbomS(e.row)}}})]}}],null,!1,2092901446)})],1):t._e(),t._v(" "),s("auditLog",{attrs:{tableData:t.SapAudit}})],1)},staticRenderFns:[]};var r=s("C7Lr")(o,l,!1,function(t){s("7xD5")},"data-v-7acc502a",null);e.default=r.exports}});
//# sourceMappingURL=85.7a2dbdcd33706dbbd14b.js.map