webpackJsonp([27,104],{"4A/W":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("mvHQ"),s=i.n(a),r=i("P9l9"),n={name:"DeviceManage",data:function(){return{arrList:[],deptId:0,visible:!1,OrgTree:[],param:{param:""},deviceList:[],multipleSelection:[],totalCount:0,currPage:1,pageSize:10}},mounted:function(){this.getTree()},methods:{getTree:function(){var e=this;this.$http(""+r.c.ORGSTRUCTURE_API,"GET",{}).then(function(t){var i=t.data;console.log(i),0===i.code?(e.OrgTree=i.deptList,e.arrList=[e.OrgTree[0].children[0].deptId]):e.$message.error(i.msg)})},setdetail:function(e){this.deptId=e.deptId,this.getList()},getList:function(e){var t=this;e&&(this.currPage=1),this.$http(""+r.c.DEVICELIST1_API,"POST",{param:this.param.param,deptId:this.deptId,currPage:s()(this.currPage),pageSize:s()(this.pageSize)}).then(function(e){var i=e.data;t.visible=!1,0===i.code?(t.deviceList=i.list.list,t.pageSize=i.list.pageSize,t.totalCount=i.list.totalCount,t.currPage=i.list.currPage):t.$message.error(i.msg),t.multipleSelection=[]})},handleSelectionChange:function(e){var t=this;this.multipleSelection=[],e.forEach(function(e,i){t.multipleSelection.push(e.deviceId)})},indexMethod:function(e){return e+1+(1*this.currPage-1)*(1*this.pageSize)},addOrupdate:function(e,t){var i=this;0===e?this.$message.error("请选择部门后新增"):(this.visible=!0,this.$nextTick(function(){i.$refs.addOrupdate.init(e,t)}))},remove:function(){var e=this;0===this.multipleSelection.length?this.$message.error("请选择要删除的设备"):this.$confirm("确认删除设备, 是否继续?","删除设备",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$http(""+r.c.DEVICEDEL_API,"POST",e.multipleSelection).then(function(t){var i=t.data;console.log(i),0===i.code?(e.$message({type:"success",message:"删除成功!"}),e.multipleSelection=[],e.getList()):e.$message.error(i.msg)})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},handleSizeChange:function(e){this.pageSize=e,this.getList()},handleCurrentChange:function(e){this.currPage=e,this.getList()}},computed:{},components:{AddOrupdate:i("cVbh").default}},o={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-col",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.lodingStatus,expression:"lodingStatus",modifiers:{fullscreen:!0,lock:!0}}],attrs:{"element-loading-text":"加载中"}},[i("div",{staticClass:"main"},[i("el-card",[i("el-row",{staticClass:"clearfix"},[i("div",{staticStyle:{float:"right"}},[i("el-form",{staticClass:"topforms2",attrs:{inline:!0,model:e.param,size:"small","label-width":"68px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getList(!0)},submit:function(e){e.preventDefault()}}},[i("el-form-item",[i("el-input",{attrs:{placeholder:"设备编号","suffix-icon":"el-icon-search"},model:{value:e.param.param,callback:function(t){e.$set(e.param,"param",t)},expression:"param.param"}})],1),e._v(" "),i("el-form-item",[e.isAuth("sys:device:checkList")?i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.getList(!0)}}},[e._v("查询")]):e._e()],1)],1)],1)]),e._v(" "),i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:8}},[i("el-card",{staticClass:"orgcard"},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[e._v("组织架构一览")])]),e._v(" "),i("el-tree",{attrs:{data:e.OrgTree,"node-key":"deptId","default-expanded-keys":e.arrList,"expand-on-click-node":!1},on:{"node-click":e.setdetail}})],1)],1),e._v(" "),i("el-col",{attrs:{span:16}},[i("el-card",{staticClass:"orgcard"},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[e._v("设备管理")])]),e._v(" "),i("div",[e.isAuth("sys:device:delete")?i("el-button",{staticStyle:{float:"right","margin-bottom":"20px"},attrs:{type:"danger",size:"small"},on:{click:function(t){return e.remove()}}},[e._v("批量删除")]):e._e(),e._v(" "),e.isAuth("sys:device:save")?i("el-button",{staticStyle:{float:"right","margin-bottom":"20px","margin-right":"10px"},attrs:{type:"primary",size:"small"},on:{click:function(t){return e.addOrupdate(e.deptId)}}},[e._v("新增")]):e._e(),e._v(" "),i("el-table",{ref:"table1",staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{border:"","header-row-class-name":"tableHead",data:e.deviceList,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"34"}}),e._v(" "),i("el-table-column",{attrs:{type:"index",index:e.indexMethod,label:"序号",width:"55"}}),e._v(" "),i("el-table-column",{attrs:{prop:"deviceNo",width:"120","show-overflow-tooltip":!0,label:"设备编号"}}),e._v(" "),i("el-table-column",{attrs:{prop:"deviceName",label:"设备描述","show-overflow-tooltip":!0}}),e._v(" "),i("el-table-column",{attrs:{fixed:"right",label:"操作",width:"65"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.isAuth("sys:device:update")?i("el-button",{attrs:{type:"text"},on:{click:function(i){return e.addOrupdate(e.deptId,t.row)}}},[e._v("编辑")]):e._e()]}}])})],1)],1),e._v(" "),i("el-row",[i("el-pagination",{attrs:{"current-page":e.currPage,"page-sizes":[10,15,20],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1)],1)],1)],1),e._v(" "),e.visible?i("add-orupdate",{ref:"addOrupdate",on:{refreshDataList:function(t){return e.getList()}}}):e._e()],1)},staticRenderFns:[]};var l=i("C7Lr")(n,o,!1,function(e){i("4ffB")},null,null);t.default=l.exports},"4ffB":function(e,t){},"R6I/":function(e,t){},cVbh:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("P9l9"),s={name:"DeviceAddorUpdate",data:function(){return{id:"",visible:!1,form:{deviceName:"",deviceNo:""},submitType:!0}},mounted:function(){},methods:{init:function(e,t){this.visible=!0,this.form={},t&&(this.form=t,this.id=t.deviceId),this.form.deptId=e},submitForm:function(){var e=this;this.submitType&&(this.submitType=!1,this.id?this.$http(""+a.c.DEVICEUPDATE_API,"POST",this.form).then(function(t){var i=t.data;console.log(i),0===i.code?e.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){e.submitType=!0,e.visible=!1,e.$emit("refreshDataList")}}):(e.submitType=!0,e.$message.error(i.msg))}):this.$http(""+a.c.DEVICEADD_API,"POST",this.form).then(function(t){var i=t.data;console.log(i),0===i.code?e.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){e.submitType=!0,e.visible=!1,e.$emit("refreshDataList")}}):(e.submitType=!0,e.$message.error(i.msg))}))}},computed:{},components:{}},r={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{title:e.form.deviceId?"修改设备信息":"新增设备","close-on-click-modal":!1,visible:e.visible},on:{"update:visible":function(t){e.visible=t}}},[i("div",[i("el-form",{staticClass:"devicedialog",attrs:{model:e.form,size:"small","label-width":"110px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitForm()}}},[i("el-form-item",{attrs:{label:"设备编号："}},[i("el-input",{attrs:{placeholder:"手工录入"},model:{value:e.form.deviceNo,callback:function(t){e.$set(e.form,"deviceNo",t)},expression:"form.deviceNo"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"设备描述："}},[i("el-input",{attrs:{placeholder:"手工录入"},model:{value:e.form.deviceName,callback:function(t){e.$set(e.form,"deviceName",t)},expression:"form.deviceName"}})],1)],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确定")])],1)])},staticRenderFns:[]};var n=i("C7Lr")(s,r,!1,function(e){i("R6I/")},"data-v-445ad732",null);t.default=n.exports}});
//# sourceMappingURL=27.ac17000de1e8edf3e77d.js.map