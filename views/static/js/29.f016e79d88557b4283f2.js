webpackJsonp([29,83],{"3kLz":function(e,t){},"6Ynz":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("mvHQ"),o=a.n(r),i=a("iMLQ"),s=a("P9l9"),l={name:"UserManages",data:function(){return{condition:{param:""},visible:!1,deptId:"",OrgTree:[],userArr:[],multipleSelection:[],totalCount:1,currPage:1,arrList:[],pageSize:10}},mounted:function(){this.getTree()},methods:{indexMethod:function(e){return e+1+(1*this.currPage-1)*(1*this.pageSize)},getTree:function(){var e=this;this.$http(""+s.c.ORGSTRUCTURE_API,"GET",{}).then(function(t){var a=t.data;0===a.code?(e.OrgTree=a.deptList,e.arrList=[e.OrgTree[0].children[0].deptId]):e.$message.error(a.msg)})},setdetail:function(e){this.deptId=e.deptId,this.getList()},getList:function(e){var t=this;e&&(this.currPage=1),this.deptId?this.$http(""+s.k.USERLIST1_API,"POST",{deptId:this.deptId,param:this.condition.param,currPage:o()(this.currPage),pageSize:o()(this.pageSize)}).then(function(e){var a=e.data;0===a.code?(t.multipleSelection=[],t.userArr=a.page.list,t.currPage=a.page.currPage,t.pageSize=a.page.pageSize,t.totalCount=a.page.totalCount):t.$message.error(a.msg),t.visible=!1}):this.$message.error("请选择组织层级")},handleSelectionChange:function(e){var t=this;this.multipleSelection=[],e.forEach(function(e,a){t.multipleSelection.push(e.userId)})},addOrupdate:function(e){var t=this;this.deptId?(this.visible=!0,this.$nextTick(function(){t.$refs.addOrupdate.init(t.deptId,e)})):this.$message.error("请先选择部门")},remove:function(){var e=this;0===this.multipleSelection.length?this.$message.error("请选择要删除的用户"):this.$confirm("确认删除用户, 是否继续?","删除用户",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$http(""+s.k.USERDEL_API,"POST",e.multipleSelection).then(function(t){var a=t.data;console.log(a),0===a.code?(e.$message({type:"success",message:"删除成功!"}),e.multipleSelection=[],e.getList()):e.$message.error(a.msg)})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},handleSizeChange:function(e){this.pageSize=e,this.getList()},handleCurrentChange:function(e){this.currPage=e,this.getList()}},computed:{},components:{UserAddOrUpdate:i.default}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-col",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.lodingStatus,expression:"lodingStatus",modifiers:{fullscreen:!0,lock:!0}}],attrs:{"element-loading-text":"加载中"}},[a("div",{staticClass:"main"},[a("el-card",[a("el-row",{staticClass:"clearfix"},[a("div",{staticStyle:{float:"right"}},[a("el-form",{staticClass:"topforms2",attrs:{inline:!0,model:e.condition,size:"small","label-width":"68px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getList(!0)}}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"用户名/工号","suffix-icon":"el-icon-search"},model:{value:e.condition.param,callback:function(t){e.$set(e.condition,"param",t)},expression:"condition.param"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.getList(!0)}}},[e._v("查询")])],1)],1)],1)]),e._v(" "),a("el-row",{attrs:{type:"flex",gutter:20}},[a("el-col",{attrs:{span:8}},[a("el-card",[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("组织架构")])]),e._v(" "),a("el-tree",{attrs:{data:e.OrgTree,"node-key":"deptId","default-expanded-keys":e.arrList,"expand-on-click-node":!1},on:{"node-click":e.setdetail}})],1)],1),e._v(" "),e.isAuth("sys:user:checkList")?a("el-col",{attrs:{span:16}},[a("el-card",[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("人员")])]),e._v(" "),a("div",[e.isAuth("sys:user:delete")?a("el-button",{staticStyle:{float:"right",margin:"0 20px 20px 0"},attrs:{type:"danger",size:"small"},on:{click:function(t){return e.remove()}}},[e._v("批量删除")]):e._e(),e._v(" "),e.isAuth("sys:user:save")?a("el-button",{staticStyle:{float:"right",margin:"0 20px 20px 0"},attrs:{type:"primary",size:"small"},on:{click:function(t){return e.addOrupdate()}}},[e._v("增加")]):e._e(),e._v(" "),a("el-table",{ref:"table1",staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{data:e.userArr,"header-row-class-name":"tableHead",border:"","tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"34"}}),e._v(" "),a("el-table-column",{attrs:{type:"index",index:e.indexMethod,width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"workNum",label:"人员工号",width:"87"}}),e._v(" "),a("el-table-column",{attrs:{prop:"workNumTemp",label:"虚拟工号",width:"110"}}),e._v(" "),a("el-table-column",{attrs:{prop:"realName",label:"人员姓名",width:"87"}}),e._v(" "),a("el-table-column",{attrs:{prop:"post",label:"职务","show-overflow-tooltip":!0,width:"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"email",label:"邮箱","show-overflow-tooltip":!0,width:"250"}}),e._v(" "),a("el-table-column",{attrs:{prop:"mobile",label:"手机号","show-overflow-tooltip":!0,width:"112"}}),e._v(" "),a("el-table-column",{attrs:{prop:"created",label:"创建日期",width:"160"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right",width:"65"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.isAuth("sys:user:update")&&e.isAuth("sys:user:info")?a("el-button",{staticStyle:{padding:"0"},attrs:{type:"text"},on:{click:function(a){return e.addOrupdate(t.row.userId)}}},[e._v("编辑")]):e._e()]}}],null,!1,1375375597)})],1)],1),e._v(" "),a("el-row",[a("el-pagination",{attrs:{"current-page":e.currPage,"page-sizes":[10,15,20],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1):e._e()],1)],1)],1),e._v(" "),e.visible?a("user-add-or-update",{ref:"addOrupdate",on:{refreshDataList:e.getList}}):e._e()],1)},staticRenderFns:[]};var d=a("C7Lr")(l,n,!1,function(e){a("3kLz")},"data-v-0f6727ff",null);t.default=d.exports},"9oAd":function(e,t){},iMLQ:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("P9l9"),o={name:"UserAddOrUpdate",data:function(){return{deptId:"",userId:"",visible:!1,dataForm:{name:"",realName:"",workNum:"",workNumTemp:"",post:"",email:"",mobile:""},type:!0,dataRule:{realName:[{required:!0,message:"人员姓名不能为空",trigger:"blur"}]}}},mounted:function(){},methods:{init:function(e,t){var a=this;this.deptId=e,t?(this.userId=t,this.$http(r.k.USERDETAIL_API+"/"+t,"GET").then(function(e){var t=e.data;console.log(t),0===t.code?a.dataForm=t.user:a.$message.error(t.msg)})):(this.userId="",this.dataForm={}),this.visible=!0},dataFormSubmit:function(){var e=this;this.dataForm.deptId=this.deptId,this.$refs.dataForm.validate(function(t){t&&e.type&&(e.type=!1,e.dataForm.workNum||e.dataForm.workNumTemp?e.userId?e.$http(""+r.k.USERUPDATE_API,"POST",e.dataForm).then(function(t){var a=t.data;console.log(a),0===a.code?e.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){e.type=!0,e.visible=!1,e.$emit("refreshDataList")}}):(e.type=!0,e.$message.error(a.msg))}):e.$http(""+r.k.USERADD_API,"POST",e.dataForm).then(function(t){var a=t.data;console.log(a),0===a.code?e.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){e.type=!0,e.visible=!1,e.$emit("refreshDataList")}}):(e.type=!0,e.$message.error(a.msg))}):(e.type=!0,e.$message.error("人员工号和虚拟工号必须添加一个")))})}},computed:{},components:{}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.userId?"修改人员信息":"新增人员","close-on-click-modal":!1,visible:e.visible},on:{"update:visible":function(t){e.visible=t}}},[a("div",[a("el-form",{ref:"dataForm",attrs:{model:e.dataForm,"status-icon":"",rules:e.dataRule,"label-width":"100px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.dataFormSubmit()}}},[a("el-form-item",{attrs:{label:"人员工号："}},[a("el-input",{attrs:{placeholder:"手动输入"},model:{value:e.dataForm.workNum,callback:function(t){e.$set(e.dataForm,"workNum",t)},expression:"dataForm.workNum"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"虚拟工号："}},[a("el-input",{attrs:{placeholder:"手动输入"},model:{value:e.dataForm.workNumTemp,callback:function(t){e.$set(e.dataForm,"workNumTemp",t)},expression:"dataForm.workNumTemp"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"人员姓名：",prop:"realName"}},[a("el-input",{attrs:{placeholder:"手动输入","auto-complete":"off"},model:{value:e.dataForm.realName,callback:function(t){e.$set(e.dataForm,"realName",t)},expression:"dataForm.realName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"职务："}},[a("el-input",{attrs:{placeholder:"手动输入"},model:{value:e.dataForm.post,callback:function(t){e.$set(e.dataForm,"post",t)},expression:"dataForm.post"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"邮箱："}},[a("el-input",{attrs:{placeholder:"手动输入"},model:{value:e.dataForm.email,callback:function(t){e.$set(e.dataForm,"email",t)},expression:"dataForm.email"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号："}},[a("el-input",{attrs:{placeholder:"手动输入"},model:{value:e.dataForm.mobile,callback:function(t){e.$set(e.dataForm,"mobile",t)},expression:"dataForm.mobile"}})],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.dataFormSubmit}},[e._v("确定")])],1)])},staticRenderFns:[]};var s=a("C7Lr")(o,i,!1,function(e){a("9oAd")},"data-v-940eaa9e",null);t.default=s.exports}});
//# sourceMappingURL=29.f016e79d88557b4283f2.js.map