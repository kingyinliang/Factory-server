webpackJsonp([71],{iMED:function(e,t){},ydpC:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("BO1k"),s=r.n(a),o=r("P9l9"),i=r("Lna1"),l={name:"water",data:function(){return{isRedact:!1,contentshow:!1,succmessage:"",orderStatus:"",factory:[],workshop:[],productline:[],formHeader:{factory:"",workShop:"",productLine:"",productDate:"",upMan:"",upDate:"",clickstatus:"saved"},waterList:[],visible:!1,selctId:[],userlist:[],filterMethod:function(e,t){return t.screncon.indexOf(e)>-1},multipleSelection:[]}},mounted:function(){Object(i.f)(this.$),this.Getdeptcode()},watch:{"formHeader.factory":function(e,t){this.Getdeptbyid(e)},"formHeader.workShop":function(e,t){this.GetParentline(e)}},methods:{Getdeptcode:function(){var e=this;this.$http(o.c.FINDORG_API+"?code=factory","POST").then(function(t){var r=t.data;0===r.code?e.factory=r.typeList:e.$message.error(r.msg)})},Getdeptbyid:function(e){var t=this;this.formHeader.workShop="",this.formHeader.productLine="",e?this.$http(""+o.c.FINDORGBYID_API,"POST",{deptId:e,deptName:"压榨"}).then(function(e){var r=e.data;0===r.code?t.workshop=r.typeList:t.$message.error(r.msg)}):this.workshop=[]},GetParentline:function(e){var t=this;this.formHeader.productLine="",e?this.$http(""+o.c.FINDORGBYPARENTID1_API,"POST",{parentId:e,deptType:"proLine"}).then(function(e){var r=e.data;0===r.code?t.productline=r.childList:t.$message.error(r.msg)}):this.productline=[]},SearchList:function(){var e=this;this.contentshow=!0,this.$http(""+o.j.WATERLIST_API,"POST",{factory:this.formHeader.factory,workShop:this.formHeader.workShop,productLine:this.formHeader.productLine,productDate:this.formHeader.productDate}).then(function(t){var r=t.data;0===r.code?(e.waterList=r.drechinfo,e.waterList.map(function(t){e.$set(t,"drenchTime",((new Date-new Date(t.pulpEndDate))/36e5).toFixed(2))})):e.$message.error(r.msg)})},selectUser:function(e){var t=this;this.isRedact&&(this.row=e,this.$http(""+o.k.USERLIST_API,"POST",{deptId:this.formHeader.workShop}).then(function(e){var r=e.data;0===r.code?(t.userlist=Object(i.j)(r.page.list),t.row.moveOperator&&(t.selctId=t.row.moveOperator.split(",")),t.visible=!0):t.$message.error(r.msg)}))},updatauser:function(e){this.$set(e,"moveOperator",this.selctId.join(",")),this.selctId=[],this.visible=!1},SubmitForm:function(){var e=this;this.$confirm("确认提交该订单, 是否继续?","提交订单",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.savedOrSubmitForm("submit")})},savedOrSubmitForm:function(e){var t=this,r=void 0;if("submit"===e){if(0===this.multipleSelection.length)return this.$message.error("没有勾选提交数据"),!1;var a=!0,i=!1,l=void 0;try{for(var n,c=s()(this.multipleSelection);!(a=(n=c.next()).done);a=!0){var d=n.value;if(!d.moveOperator||""===d.moveOperator)return this.$message.error("请选择挪笼操作人"),!1}}catch(e){i=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw l}}r=o.j.WATERSUBMIT_API,this.succmessage="提交成功",this.$http(""+r,"POST",this.multipleSelection).then(function(e){var r=e.data;0===r.code?(t.SearchList(),t.$message.success(t.succmessage),t.isRedact=!1):t.$message.error(r.msg)})}else r=o.j.WATERSAVE_API,this.succmessage="保存成功",this.$http(""+r,"POST",this.waterList).then(function(e){var r=e.data;0===r.code?(t.SearchList(),t.$message.success(t.succmessage),t.isRedact=!1):t.$message.error(r.msg)})},handleSelectionChange:function(e){this.multipleSelection=e}}},n={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"main"},[r("el-card",{staticClass:"newCard searchCard"},[r("el-row",[r("el-col",[r("el-form",{attrs:{model:e.formHeader,inline:!0,size:"small","label-width":"75px"}},[r("el-form-item",{attrs:{label:"生产工厂："}},[r("el-select",{staticClass:"width180px",attrs:{placeholder:"请选择"},model:{value:e.formHeader.factory,callback:function(t){e.$set(e.formHeader,"factory",t)},expression:"formHeader.factory"}},[r("el-option",{attrs:{label:"请选择",value:""}}),e._v(" "),e._l(e.factory,function(e,t){return r("el-option",{key:t,attrs:{label:e.deptName,value:e.deptId}})})],2)],1),e._v(" "),r("el-form-item",{attrs:{label:"生产车间："}},[r("el-select",{staticClass:"width180px",attrs:{placeholder:"请选择"},model:{value:e.formHeader.workShop,callback:function(t){e.$set(e.formHeader,"workShop",t)},expression:"formHeader.workShop"}},[r("el-option",{attrs:{label:"请选择",value:""}}),e._v(" "),e._l(e.workshop,function(e,t){return r("el-option",{key:t,attrs:{label:e.deptName,value:e.deptId}})})],2)],1),e._v(" "),r("el-form-item",{attrs:{label:"布浆线："}},[r("el-select",{staticClass:"width180px",attrs:{placeholder:"请选择"},model:{value:e.formHeader.productLine,callback:function(t){e.$set(e.formHeader,"productLine",t)},expression:"formHeader.productLine"}},[r("el-option",{attrs:{label:"请选择",value:""}}),e._v(" "),e._l(e.productline,function(e,t){return r("el-option",{key:t,attrs:{label:e.deptName,value:e.deptId}})})],2)],1)],1)],1)],1),e._v(" "),r("el-row",{staticStyle:{"text-align":"right"}},[[e.isAuth("prs:drench:drenchList")?r("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.SearchList}},[e._v("查询")]):e._e(),e._v(" "),"submit"!==e.orderStatus&&"checked"!==e.orderStatus&&e.isAuth("prs:dernchUpdate")?r("el-button",{staticClass:"button",attrs:{type:"primary",size:"small"},on:{click:function(t){e.isRedact=!e.isRedact}}},[e._v(e._s(e.isRedact?"取消":"编辑"))]):e._e()],e._v(" "),e.isRedact?[e.isAuth("prs:dernchUpdate")?r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.savedOrSubmitForm("saved")}}},[e._v("保存")]):e._e(),e._v(" "),e.isAuth("prs:dernchUpdate")?r("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.SubmitForm}},[e._v("提交")]):e._e()]:e._e()],2),e._v(" "),r("div",{staticClass:"toggleSearchBottom"},[r("i",{staticClass:"el-icon-caret-top"})])],1),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.contentshow,expression:"contentshow"}],staticClass:"tableCard"},[e._m(0),e._v(" "),r("el-card",{staticStyle:{"margin-top":"10px"}},[r("el-table",{attrs:{data:e.waterList,border:"","header-row-class-name":"tableHead"},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"35"}}),e._v(" "),r("el-table-column",{attrs:{label:"工序",width:"50px"}},[e._v("自淋")]),e._v(" "),r("el-table-column",{attrs:{label:"气垫车号",prop:"gx"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.deviceName)+"\n          ")]}}])},[r("template",{slot:"header"},[r("i",{staticClass:"reqI"},[e._v("*")]),r("span",[e._v("气垫车号")])])],2),e._v(" "),r("el-table-column",{attrs:{label:"布浆线",prop:"deptName"}}),e._v(" "),r("el-table-column",{attrs:{label:"布浆结束时间",prop:"pulpEndDate"}}),e._v(" "),r("el-table-column",{attrs:{label:"自淋时间(H)",prop:"drenchTime"}}),e._v(" "),r("el-table-column",{attrs:{label:"挪笼操作员","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.moveOperator?r("span",{style:{cursor:e.isRedact?"pointer":""},on:{click:function(r){return e.selectUser(t.row)}}},[e._v(e._s(t.row.moveOperator))]):r("el-col",[r("span",{style:{cursor:e.isRedact?"pointer":""},on:{click:function(r){return e.selectUser(t.row)}}},[r("i",[e._v(e._s(t.row.moveOperator))]),e._v(" "),r("i",[e._v("点击选择人员")])])])]}}])},[r("template",{slot:"header"},[r("i",{staticClass:"reqI"},[e._v("*")]),r("span",[e._v("挪笼操作员")])])],2),e._v(" "),r("el-table-column",{attrs:{label:"布浆操作员",prop:"drenchOperator"}})],1)],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"人员分配","close-on-click-modal":!1,visible:e.visible},on:{"update:visible":function(t){e.visible=t}}},[r("el-row",[r("el-col",{staticStyle:{width:"500px"}},[r("el-transfer",{attrs:{filterable:"",titles:["未分配人员","已分配人员"],"filter-method":e.filterMethod,"filter-placeholder":"请输入用户名称",data:e.userlist},model:{value:e.selctId,callback:function(t){e.selctId=t},expression:"selctId"}})],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.updatauser(e.row)}}},[e._v("确定")])],1)],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"toggleSearchTop",staticStyle:{"background-color":"white","margin-bottom":"8px",position:"relative","border-radius":"5px"}},[t("i",{staticClass:"el-icon-caret-bottom"})])}]};var c=r("C7Lr")(l,n,!1,function(e){r("iMED")},"data-v-dc6084ea",null);t.default=c.exports}});
//# sourceMappingURL=71.1faf3d4de327144798eb.js.map