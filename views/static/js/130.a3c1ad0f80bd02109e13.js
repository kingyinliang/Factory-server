webpackJsonp([130],{P8VM:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r("BO1k"),a=r.n(s),o=r("Lna1"),l=r("P9l9"),i={name:"pressmaterial",data:function(){return{proPressList:[],materialList:[],visible:!1,selctId:[],userlist:[],filterMethod:function(e,t){return t.screncon.indexOf(e)>-1},multipleSelection:[],formInline:{destoryNumEast:"",destoryNumWest:""}}},props:["isRedact","formHeader"],mounted:function(){Object(o.b)(this.$)},watch:{"formHeader.pressure":function(e,t){this.materialList=[]},"formHeader.workShop":function(e,t){this.materialList=[]}},methods:{GetpulpMachine:function(e){var t=this;if(this.formHeader.workShop){var r=void 0;r=1===this.formHeader.pressure?"预压":"终压",this.$http(""+l.c.DEVICELIST_API,"POST",{param:r,deptId:this.formHeader.workShop,currPage:"1",pageSize:"50"}).then(function(e){var r=e.data;0===r.code?t.proPressList=r.list.list:t.$message.error(r.msg)})}},GetMateriaList:function(e){var t=this;this.$http(""+l.j.PRESSLIST_API,"POST",{factory:e.factory,workShop:e.workShop,pressure:e.pressure,productLine:e.productLine,productDate:e.productDate}).then(function(e){var r=e.data;0===r.code?(t.materialList=r.pressInfo,"D79ECC0CBB1F483EB4136A3720B68B3D"===t.formHeader.workShop&&2===t.formHeader.pressure&&(t.formInline.destoryNumEast=t.materialList[0].destoryNumEast,t.formInline.destoryNumWest=t.materialList[0].destoryNumWest)):t.$message.error(r.msg)})},changePrePress:function(e){e.prePressStart&&e.prePressEnd&&this.materialList.map(function(t){e.id===t.id&&(t.prePressTime=((new Date(e.prePressEnd)-new Date(t.prePressStart))/36e5).toFixed(2))})},changendPrePress:function(e){e.pressStart&&e.pressEnd&&this.materialList.map(function(t){e.id===t.id&&(t.pressTime=((new Date(e.pressEnd)-new Date(t.pressStart))/36e5).toFixed(2))})},selectUser:function(e){var t=this;this.isRedact&&(this.row=e,this.$http(""+l.k.USERLIST_API,"POST",{deptId:this.formHeader.workShop}).then(function(e){var r=e.data;0===r.code?(t.userlist=Object(o.j)(r.page.list),t.row.suitOperator&&(t.selctId=t.row.suitOperator.split(",")),t.visible=!0):t.$message.error(r.msg)}))},updatauser:function(e){this.$set(e,"suitOperator",this.selctId.join(",")),this.selctId=[],this.visible=!1},submitMaterial:function(e,t){var r=this;if(0===this.multipleSelection.length)return this.$message.error("请勾选提交数据"),!1;var s=!0,o=!1,i=void 0;try{for(var n,d=a()(this.multipleSelection);!(s=(n=d.next()).done);s=!0){var c=n.value;if(1===this.formHeader.pressure){if(!c.prePressNo||""===c.prePressNo||!c.prePressStart||""===c.prePressStart||!c.prePressEnd||""===c.prePressEnd)return this.$message.error("请填写必填项"),!1}else{if(!c.pressNo||""===c.pressNo||!c.pressStart||""===c.pressStart||!c.pressEnd||""===c.pressEnd)return this.$message.error("请填写必填项"),!1;if("C4F2B8DAD6C14D1C8DC44821F9E2636D"===this.formHeader.workShop&&(!c.destoryNum||""===c.destoryNum))return this.$message.error("请填写必填项"),!1;if("D79ECC0CBB1F483EB4136A3720B68B3D"===this.formHeader.workShop){if(""===this.formInline.destoryNumEast||!this.formInline.destoryNumEast||""===this.formInline.destoryNumWest||!this.formInline.destoryNumWest)return this.$message.error("请填写必填项"),!1;this.multipleSelection.map(function(e){r.$set(e,"destoryNumEast",r.formInline.destoryNumEast),r.$set(e,"destoryNumWest",r.formInline.destoryNumWest)})}}}}catch(e){o=!0,i=e}finally{try{!s&&d.return&&d.return()}finally{if(o)throw i}}var u=void 0;u=1===this.formHeader.pressure?l.j.PRESSSUBMIT_API:l.j.ENDPRESSSUBMIT_API,this.$http(""+u,"POST",this.multipleSelection).then(function(t){var s=t.data;0===s.code||r.$message.error(s.msg),e&&e("resolve")}).catch(function(){e&&t("reject")})},updateMaterial:function(e,t){var r=this,s=void 0;s=1===this.formHeader.pressure?l.j.PRESSUPDATE_API:l.j.ENDPRESSUPDATE_API,"D79ECC0CBB1F483EB4136A3720B68B3D"===this.formHeader.workShop&&this.materialList.map(function(e){var t=0,s=0;r.formInline.destoryNumEast&&""!==r.formInline.destoryNumEast&&(t=r.formInline.destoryNumEast),r.formInline.destoryNumWest&&""!==r.formInline.destoryNumWest&&(s=r.formInline.destoryNumWest),r.$set(e,"destoryNumEast",t),r.$set(e,"destoryNumWest",s)}),this.$http(""+s,"POST",this.materialList).then(function(t){var s=t.data;0===s.code||r.$message.error(s.msg),e&&e("resolve")}).catch(function(){e&&t("reject")})},handleSelectionChange:function(e){this.multipleSelection=e}}},n={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-card",[1===this.formHeader.pressure?r("el-table",{attrs:{data:e.materialList,border:"","header-row-class-name":"tableHead"},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"35"}}),e._v(" "),r("el-table-column",{attrs:{label:"工序",width:"50px"}},[e._v("预压")]),e._v(" "),r("el-table-column",{key:Math.random(),attrs:{width:"120px",prop:"deviceName"}},[r("template",{slot:"header"},[r("i",{staticClass:"reqI"},[e._v("*")]),r("span",[e._v("气垫车号")])])],2),e._v(" "),r("el-table-column",{key:Math.random(),attrs:{label:"布浆线",prop:"deptName",width:"80px"}}),e._v(" "),r("el-table-column",{key:Math.random(),attrs:{label:"自淋时间(H)",prop:"drenchTime",width:"120px"}}),e._v(" "),r("el-table-column",{key:Math.random(),attrs:{width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-select",{attrs:{placeholder:"请选择",size:"small",disabled:!e.isRedact},model:{value:t.row.prePressNo,callback:function(r){e.$set(t.row,"prePressNo",r)},expression:"scope.row.prePressNo"}},e._l(e.proPressList,function(e){return r("el-option",{key:e.deviceId,attrs:{label:e.deviceName,value:e.deviceId}})}),1)]}}],null,!1,1609566536)},[r("template",{slot:"header"},[r("i",{staticClass:"reqI"},[e._v("*")]),r("span",[e._v("预压机号")])])],2),e._v(" "),r("el-table-column",{key:Math.random(),attrs:{width:"195px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-date-picker",{staticStyle:{width:"175px"},attrs:{type:"datetime",placeholder:"选择日期",format:"yyyy-MM-dd HH:mm","value-format":"yyyy-MM-dd HH:mm",size:"small",disabled:!e.isRedact},on:{input:function(r){return e.changePrePress(t.row)}},model:{value:t.row.prePressStart,callback:function(r){e.$set(t.row,"prePressStart",r)},expression:"scope.row.prePressStart"}})]}}],null,!1,1462464709)},[r("template",{slot:"header"},[r("i",{staticClass:"reqI"},[e._v("*")]),r("span",[e._v("预压开始时间")])])],2),e._v(" "),r("el-table-column",{key:Math.random(),attrs:{width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-date-picker",{staticStyle:{width:"175px"},attrs:{type:"datetime",placeholder:"选择日期",format:"yyyy-MM-dd HH:mm","value-format":"yyyy-MM-dd HH:mm",size:"small",disabled:!e.isRedact},on:{input:function(r){return e.changePrePress(t.row)}},model:{value:t.row.prePressEnd,callback:function(r){e.$set(t.row,"prePressEnd",r)},expression:"scope.row.prePressEnd"}})]}}],null,!1,2193816202)},[r("template",{slot:"header"},[r("i",{staticClass:"reqI"},[e._v("*")]),r("span",[e._v("预压结束时间")])])],2),e._v(" "),r("el-table-column",{key:Math.random(),attrs:{label:"预压时间(H)",prop:"prePressTime",width:"110px"}}),e._v(" "),"C4F2B8DAD6C14D1C8DC44821F9E2636D"===this.formHeader.workShop?r("el-table-column",{key:Math.random(),attrs:{label:"终止压力(Mpa)",width:"180px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{attrs:{size:"small",disabled:!e.isRedact},model:{value:t.row.endPress,callback:function(r){e.$set(t.row,"endPress",r)},expression:"scope.row.endPress"}})]}}],null,!1,1610283177)}):e._e(),e._v(" "),"C4F2B8DAD6C14D1C8DC44821F9E2636D"===this.formHeader.workShop?r("el-table-column",{key:Math.random(),attrs:{label:"调压人员",width:"150px","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.suitOperator?r("span",{style:{cursor:e.isRedact?"pointer":""},on:{click:function(r){return e.selectUser(t.row)}}},[e._v(e._s(t.row.suitOperator))]):r("el-col",[r("span",{style:{cursor:e.isRedact?"pointer":""},on:{click:function(r){return e.selectUser(t.row)}}},[r("i",[e._v(e._s(t.row.suitOperator))]),e._v(" "),r("i",[e._v("点击选择人员")])])])]}}],null,!1,1356823829)}):e._e(),e._v(" "),r("el-table-column",{attrs:{label:"挪笼人员",prop:"moveOperator","show-overflow-tooltip":!0,width:"150"}})],1):e._e(),e._v(" "),2===this.formHeader.pressure?r("el-table",{attrs:{data:e.materialList,border:"","header-row-class-name":"tableHead"},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"35"}}),e._v(" "),r("el-table-column",{attrs:{label:"工序",width:"50px"}},[e._v("终压")]),e._v(" "),r("el-table-column",{key:Math.random(),attrs:{width:"100px",prop:"deviceName"}},[r("template",{slot:"header"},[r("i",{staticClass:"reqI"},[e._v("*")]),r("span",[e._v("气垫车号")])])],2),e._v(" "),r("el-table-column",{key:Math.random(),attrs:{label:"布浆线",prop:"deptName",width:"80px"}}),e._v(" "),r("el-table-column",{key:Math.random(),attrs:{width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-select",{attrs:{placeholder:"请选择",size:"small",disabled:!e.isRedact},model:{value:t.row.pressNo,callback:function(r){e.$set(t.row,"pressNo",r)},expression:"scope.row.pressNo"}},e._l(e.proPressList,function(e){return r("el-option",{key:e.deviceId,attrs:{label:e.deviceName,value:e.deviceId}})}),1)]}}],null,!1,2196181071)},[r("template",{slot:"header"},[r("i",{staticClass:"reqI"},[e._v("*")]),r("span",[e._v("终压机号")])])],2),e._v(" "),r("el-table-column",{key:Math.random(),attrs:{width:"195px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-date-picker",{staticStyle:{width:"175px"},attrs:{type:"datetime",placeholder:"选择日期",format:"yyyy-MM-dd HH:mm","value-format":"yyyy-MM-dd HH:mm",size:"small",disabled:!e.isRedact},on:{input:function(r){return e.changendPrePress(t.row)}},model:{value:t.row.pressStart,callback:function(r){e.$set(t.row,"pressStart",r)},expression:"scope.row.pressStart"}})]}}],null,!1,2529135016)},[r("template",{slot:"header"},[r("i",{staticClass:"reqI"},[e._v("*")]),r("span",[e._v("终压开始时间")])])],2),e._v(" "),r("el-table-column",{key:Math.random(),attrs:{width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-date-picker",{staticStyle:{width:"175px"},attrs:{type:"datetime",placeholder:"选择日期",format:"yyyy-MM-dd HH:mm","value-format":"yyyy-MM-dd HH:mm",size:"small",disabled:!e.isRedact},on:{input:function(r){return e.changendPrePress(t.row)}},model:{value:t.row.pressEnd,callback:function(r){e.$set(t.row,"pressEnd",r)},expression:"scope.row.pressEnd"}})]}}],null,!1,608036583)},[r("template",{slot:"header"},[r("i",{staticClass:"reqI"},[e._v("*")]),r("span",[e._v("终压结束时间")])])],2),e._v(" "),r("el-table-column",{key:Math.random(),attrs:{label:"终压时间(H)",prop:"pressTime",width:"110px"}}),e._v(" "),"C4F2B8DAD6C14D1C8DC44821F9E2636D"===this.formHeader.workShop?r("el-table-column",{key:Math.random(),attrs:{label:"终止压力(Mpa)",width:"180px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{attrs:{size:"small"},model:{value:t.row.Press,callback:function(r){e.$set(t.row,"Press",r)},expression:"scope.row.Press"}})]}}],null,!1,888392702)}):e._e(),e._v(" "),"C4F2B8DAD6C14D1C8DC44821F9E2636D"===this.formHeader.workShop?r("el-table-column",{key:Math.random(),attrs:{label:"调压人员",width:"150px","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.suitOperator?r("span",{style:{cursor:e.isRedact?"pointer":""},on:{click:function(r){return e.selectUser(t.row)}}},[e._v(e._s(t.row.suitOperator))]):r("el-col",[r("span",{style:{cursor:e.isRedact?"pointer":""},on:{click:function(r){return e.selectUser(t.row)}}},[r("i",[e._v(e._s(t.row.suitOperator))]),e._v(" "),r("i",[e._v("点击选择人员")])])])]}}],null,!1,1356823829)}):e._e(),e._v(" "),r("el-table-column",{key:Math.random(),attrs:{label:"挪笼人员",prop:"moveOperator","show-overflow-tooltip":!0,width:"150"}}),e._v(" "),"C4F2B8DAD6C14D1C8DC44821F9E2636D"===this.formHeader.workShop?r("el-table-column",{key:Math.random(),attrs:{width:"180px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{attrs:{size:"small"},model:{value:t.row.destoryNum,callback:function(r){e.$set(t.row,"destoryNum",r)},expression:"scope.row.destoryNum"}})]}}],null,!1,2208372749)},[r("template",{slot:"header"},[r("i",{staticClass:"reqI"},[e._v("*")]),r("span",[e._v("压榨二碎布数（个）")])])],2):e._e()],1):e._e(),e._v(" "),"D79ECC0CBB1F483EB4136A3720B68B3D"===this.formHeader.workShop&&2===this.formHeader.pressure?r("el-form",{staticStyle:{"margin-top":"10px"},attrs:{inline:!0,model:e.formInline}},[r("el-form-item",[r("span",{attrs:{slot:"label"},slot:"label"},[e._v("压榨一东碎布数（张）"),r("i",{staticClass:"reqI"},[e._v("*")]),e._v(":")]),e._v(" "),r("el-input",{attrs:{disabled:!e.isRedact,size:"small"},model:{value:e.formInline.destoryNumEast,callback:function(t){e.$set(e.formInline,"destoryNumEast",t)},expression:"formInline.destoryNumEast"}})],1),e._v(" "),r("el-form-item",[r("span",{attrs:{slot:"label"},slot:"label"},[e._v("压榨一西碎布数（张）"),r("i",{staticClass:"reqI"},[e._v("*")]),e._v(":")]),e._v(" "),r("el-input",{attrs:{disabled:!e.isRedact,size:"small"},model:{value:e.formInline.destoryNumWest,callback:function(t){e.$set(e.formInline,"destoryNumWest",t)},expression:"formInline.destoryNumWest"}})],1)],1):e._e()],1),e._v(" "),r("el-dialog",{attrs:{title:"人员分配","close-on-click-modal":!1,visible:e.visible},on:{"update:visible":function(t){e.visible=t}}},[r("el-row",[r("el-col",{staticStyle:{width:"500px"}},[r("el-transfer",{attrs:{filterable:"",titles:["未分配人员","已分配人员"],"filter-method":e.filterMethod,"filter-placeholder":"请输入用户名称",data:e.userlist},model:{value:e.selctId,callback:function(t){e.selctId=t},expression:"selctId"}})],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.updatauser(e.row)}}},[e._v("确定")])],1)],1)],1)},staticRenderFns:[]},d=r("C7Lr")(i,n,!1,null,null,null);t.default=d.exports}});
//# sourceMappingURL=130.a3c1ad0f80bd02109e13.js.map