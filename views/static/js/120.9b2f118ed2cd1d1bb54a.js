webpackJsonp([120],{DuGC:function(t,e){},iAfK:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("P9l9"),o={name:"inStock",data:function(){return{InStock:[{batch:"",changed:"",changer:"",created:"",creator:"",delFlag:"0",holderId:"",houseNo:"",id:"",isSplit:"0",materialCode:"",materialName:"",orderHouseId:"",orderNo:"1",pulpWeight:"",remark:"",saltWaterWeight:"",sauceWeight:"",serialNumber:"",status:"",unit:"L",wheatWeight:""}],InStockAuditlog:[],InStockstatus:"",BrineNum:0,ThreeNum:{allP:"",allM:"",allS:""},params:{params1:"",params2:"",params3:""}}},props:{isRedact:{},formHeader:{}},mounted:function(){this.GetParams()},watch:{BrineNum:function(t,e){}},methods:{setBrineNum:function(t){this.BrineNum=t},GetThreeNum:function(t){var e=this;this.$http(""+r.d.OUTINNUMLIST_API,"POST",{orderHouseId:t.id}).then(function(t){var a=t.data;0===a.code?0!==a.list.length&&(e.ThreeNum=a.list[0]):e.$message.error(a.msg)})},GetParams:function(){var t=this;this.$http(r.k.PARAMETERLIST_API+"?type=ZQ_jianglao_canshu","POST").then(function(e){var a=e.data;0===a.code?a.dicList.forEach(function(e,a){"CANSHU1"===e.code&&(t.params.params1=1*e.value),"CANSHU2"===e.code&&(t.params.params2=1*e.value),"CANSHU3"===e.code&&(t.params.params3=1*e.value)}):t.$message.error(a.msg)})},GetOutInStorage:function(t){var e=this;this.$http(""+r.d.OUTINLIST_API,"POST",{orderId:t.orderId,orderHouseId:t.id,orderNo:t.orderNo}).then(function(t){var a=t.data;if(0===a.code){e.InStock=a.list,e.InStockAuditlog=a.vrlist;var r=0,o=0,s=0,l=0;e.InStock.forEach(function(t){"noPass"===t.status?s+=1:"submit"===t.status?r+=1:"checked"===t.status?o+=1:"saved"===t.status&&(l+=1)}),s>0?e.InStockstatus="noPass":r>0?e.InStockstatus="submit":l>0?e.InStockstatus="saved":o>0&&(e.InStockstatus="checked"),e.$emit("GetInStockStatus",e.InStockstatus),0===a.list.length&&(e.InStock=[{batch:"",changed:"",changer:"",created:"",creator:"",delFlag:"0",holderId:"",houseNo:"",id:"",isSplit:"0",materialCode:"",materialName:"",orderHouseId:"",orderNo:"1",pulpWeight:"",remark:"",saltWaterWeight:"",sauceWeight:"",serialNumber:"",status:"",unit:"L",wheatWeight:""}])}else e.$message.error(a.msg)})},InStockRul:function(){var t=this,e=!0;return this.InStock.forEach(function(a){return a.sauceWeight&&a.batch?a.pulpWeight?a.wheatWeight?a.saltWaterWeight?a.batch.length<10?(e=!1,t.$message.error("生产入库批次必须为10位"),!1):void 0:(e=!1,t.$message.error("生产入库盐水量未填"),!1):(e=!1,t.$message.error("生产入库麦粉量未填"),!1):(e=!1,t.$message.error("生产入库豆粕量未填"),!1):(e=!1,t.$message.error("生产入库必填项未填"),!1)}),e},SaveOrSubmitInStock:function(t,e,a){var o=this;this.InStock.forEach(function(e){e.materialCode=o.formHeader.materialCode,e.materialName=o.formHeader.materialName,e.orderHouseId=o.formHeader.id,e.holderName=o.formHeader.inPotName,e.holderId=o.formHeader.inPotNo,e.status?"saved"===e.status?e.status=t:"noPass"===e.status&&"submit"===t&&(e.status=t):e.status=t}),this.$http(""+("submit"===t?r.d.OUTINSUBMIT_API:r.d.OUTINSAVE_API),"POST",this.InStock).then(function(t){var r=t.data;0===r.code?e&&e("resolve"):(o.$message.error(r.msg),a&&a("生产入库"+r.msg))})},addInStock:function(t,e){this.InStock.splice(e+1,0,{pulpWeight:t.pulpWeight,wheatWeight:t.wheatWeight,saltWaterWeight:t.saltWaterWeight,materialCode:t.materialCode,materialName:t.materialName,houseNo:t.houseNo,unit:t.unit,isSplit:"1",delFlag:"0"})},delInStock:function(t){t.delFlag="1"},RowDelFlag:function(t){var e=t.row;t.rowIndex;return"1"===e.delFlag?"rowDel":""}},computed:{},components:{AuditLog:function(t){a.e(1).then(function(){var e=[a("bpq2")];t.apply(null,e)}.bind(this)).catch(a.oe)}}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-table",{attrs:{"header-row-class-name":"tableHead",data:t.InStock,"row-class-name":t.RowDelFlag,border:"","tooltip-effect":"dark"}},[a("el-table-column",{attrs:{type:"index",width:"50",label:"序号"}}),t._v(" "),a("el-table-column",{attrs:{width:"115",label:"豆粕量（KG）"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.pulpWeight=t.ThreeNum.allP)+"\n      ")]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"115",label:"麦粉量（KG）"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.wheatWeight=t.ThreeNum.allM)+"\n      ")]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"115",label:"盐水量（L）"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.saltWaterWeight=t.BrineNum)+"\n      ")]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"125",label:"入库酱醪量"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",[t._v(t._s(e.row.sauceWeight=(((1*e.row.pulpWeight+1*e.row.wheatWeight)*t.params.params1+e.row.saltWaterWeight*t.params.params2)/t.params.params3).toFixed(2)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"125",label:"入库批次"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{disabled:!(t.isRedact&&"submit"!==e.row.status&&"checked"!==e.row.status),size:"small",placeholder:"手工录入",maxlength:"10"},model:{value:e.row.batch,callback:function(a){t.$set(e.row,"batch",a)},expression:"scope.row.batch"}})]}}])},[a("template",{slot:"header"},[a("i",{staticClass:"reqI"},[t._v("*")]),t._v(" "),a("span",[t._v("入库批次")])])],2),t._v(" "),a("el-table-column",{attrs:{width:"85",label:"入罐罐号","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.holderName))]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"50",label:"单位",prop:"unit"}}),t._v(" "),a("el-table-column",{attrs:{width:"",label:"操作人",prop:"changer","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{width:"",label:"操作时间",prop:"changed","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{width:"70",label:"操作",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"===e.row.isSplit?a("el-button",{attrs:{type:"text",icon:"el-icon-delete",circle:"",size:"small",disabled:!(t.isRedact&&"submit"!==e.row.status&&"checked"!==e.row.status)},on:{click:function(a){return t.delInStock(e.row)}}},[t._v("删除")]):t._e(),t._v(" "),"0"===e.row.isSplit?a("el-button",{attrs:{type:"text",disabled:!(t.isRedact&&"submit"!==e.row.status&&"checked"!==e.row.status)},on:{click:function(a){return t.addInStock(e.row,e.$index)}}},[a("i",{staticClass:"icons iconfont factory-chaifen"}),t._v("新增")]):t._e()]}}])})],1),t._v(" "),a("audit-log",{attrs:{tableData:t.InStockAuditlog}})],1)},staticRenderFns:[]};var l=a("C7Lr")(o,s,!1,function(t){a("DuGC")},"data-v-20f5a77f",null);e.default=l.exports}});
//# sourceMappingURL=120.9b2f118ed2cd1d1bb54a.js.map