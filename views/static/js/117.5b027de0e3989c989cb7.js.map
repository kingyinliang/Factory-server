{"version":3,"sources":["webpack:///src/views/page/DataEntry/FryWheat/common/pwApplyMateriel.vue","webpack:///./src/views/page/DataEntry/FryWheat/common/pwApplyMateriel.vue?d5cd","webpack:///./src/views/page/DataEntry/FryWheat/common/pwApplyMateriel.vue"],"names":["pwApplyMateriel","data","dictListObj","dispatcherCode","materielDataList","readAudit","mounted","this","getDictList","props","isRedact","Boolean","appyMaterielState","String","order","Object","methods","saveOrderMateriel","_this","length","validate","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","get_iterator_default","next","done","value","status","err","return","$http","api","MATERIELSAVEORDER_API","then","_ref","code","$emit","orderId","orderNo","$message","error","msg","catch","console","log","saveMateriel","resolve","_this2","forEach","item","trim","MATERIELSAVE_API","_ref2","submitMateriel","_this3","MATERIELSUBMIT_API","_ref3","flag","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","delFlag","dispatchMan","productCode","issueCode","productWeight","issueBatch","inStorageWeight","inStorageBatch","_this4","PARAMETERSLIST_API","_ref4","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","dicList","dict","$set","shname","prolist","getMaterielDataList","_this5","inState","MATERIELLIST_API","_ref5","wlist","vrlist","no","sub","che","sav","finally","addNewRecord","lastArr","filter","last","nowStr","net_validate","Date","user","$store","state","realName","push","branWeight","gmCode","granuleWeight","issueName","issueWeight","productName","productUnit","remark","scrappedWeight","storageWeight","productDate","factory","workShop","productLine","created","creator","changed","changer","dellistbomS","row","rowDelFlag","_ref6","rowIndex","changeProductWeight","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","recordId","changeProduct","product","find","changeIssue","issue","computed","enableSubmit","watch","order.productDate","n","o","components","AuditLog","__webpack_require__","e","__WEBPACK_AMD_REQUIRE_ARRAY__","apply","bind","oe","common_pwApplyMateriel","render","_vm","_h","$createElement","_c","_self","attrs","body-style","span","ref","label-width","staticStyle","margin-bottom","label","size","value-key","placeholder","disabled","model","callback","$$v","expression","_l","index","key","_v","staticClass","float","type","on","click","margin-left","width","header-row-class-name","row-class-name","border","tooltip-effect","scopedSlots","_u","fn","scope","change","$event","input","_n","_s","Number","maxlength","fixed","icon","circle","tableData","staticRenderFns","Component","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/117.5b027de0e3989c989cb7.js","sourcesContent":["<!--生产入库-->\r\n<template>\r\n  <div>\r\n    <!--数据录入-->\r\n    <el-card body-style=\"padding-top:10px;\">\r\n      <el-row>\r\n        <el-col :span=\"12\">\r\n          <el-form ref=\"form\" label-width=\"100px\">\r\n            <el-form-item label=\"生产调度员\" style='margin-bottom:0px;'>\r\n              <el-select size=\"small\" v-model=\"dispatcherCode\" value-key=\"dispatcherCode\" placeholder=\"请选择生产调度员\" :disabled=\"!isRedact || appyMaterielState == 'submit' || appyMaterielState == 'checked'\" >\r\n                <el-option v-for=\"(item, index) in this.dictListObj['PW_FEVOR']\" :key=\"index\" :label=\"item.code\" :value=\"item.code\" ></el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-form>\r\n        </el-col>\r\n        <el-col :span=\"12\">\r\n          <div class=\"btn\" style=\"float:right;\">\r\n            <el-button type=\"primary\" size=\"small\" :disabled=\"!isRedact || appyMaterielState == 'submit' || appyMaterielState == 'checked'\" @click=\"addNewRecord\">新增</el-button>\r\n            <el-button type=\"primary\" style=\"margin-left:0px;\" size=\"small\" :disabled=\"!isRedact || !enableSubmit\" @click=\"saveOrderMateriel\">申请订单</el-button>\r\n            <!-- <el-button type='primary' size=\"small\" @click=\"saveMaterielList\">baocun</el-button>\r\n            <el-button type='primary' size=\"small\" @click=\"submitMaterielList\">tijiao</el-button> -->\r\n          </div>\r\n        </el-col>\r\n      </el-row>\r\n      <el-row>\r\n        <el-col :span=\"24\" >\r\n          <el-table\r\n            ref=\"table1\"\r\n            header-row-class-name=\"tableHead\"\r\n            :data=\"materielDataList\"\r\n            :row-class-name=\"rowDelFlag\"\r\n            border\r\n            tooltip-effect=\"dark\"\r\n            style=\"width: 100%;margin-bottom: 20px\">\r\n            <el-table-column\r\n              label=\"生产物料\"\r\n              width=\"220\">\r\n              <template slot-scope=\"scope\">\r\n                <div class=\"required\">\r\n                  <i class=\"reqI\">*</i>\r\n                  <el-select @change=\"changeProduct(scope.row)\"  v-model=\"scope.row.productCode\" value-key=\"productCode\" placeholder=\"请选择生产物料\"  :disabled=\"!isRedact || scope.row.status === 'submit' || scope.row.status === 'checked'\" size=\"small\">\r\n                    <el-option v-for=\"(item, index) in dictListObj['CM_material_prd']\" :key=\"index\" :label=\"item.code + ' ' + item.value\" :value=\"item.code\" ></el-option>\r\n                  </el-select>\r\n                </div>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column\r\n              width=\"140\"\r\n              label=\"生产数\">\r\n              <template slot-scope=\"scope\">\r\n                <div class=\"required\">\r\n                  <i class=\"reqI\">*</i>\r\n                  <el-input type=\"number\"  v-model.number=\"scope.row.productWeight\" @input=\"changeProductWeight(scope.row)\" :disabled=\"!isRedact || scope.row.status === 'submit' || scope.row.status === 'checked'\" size=\"small\"  placeholder=\"手工录入\"></el-input>\r\n                </div>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column\r\n              width=\"60\"\r\n              label=\"单位\">\r\n              <template slot-scope=\"scope\">\r\n                {{scope.row.productUnit = 'KG'}}\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column\r\n              width=\"220\"\r\n              label=\"发料料号\">\r\n              <template slot-scope=\"scope\">\r\n                <div class=\"required\">\r\n                  <i class=\"reqI\">*</i>\r\n                  <el-select @change=\"changeIssue(scope.row)\"  v-model=\"scope.row.issueCode\" value-key=\"issueCode\" placeholder=\"请选择发料料号\"  :disabled=\"!isRedact || scope.row.status === 'submit' || scope.row.status === 'checked'\" size=\"small\">\r\n                    <el-option v-for=\"(item, index) in dictListObj['CM_material']\" :key=\"index\" :label=\"item.code + ' ' + item.value\" :value=\"item.code\" ></el-option>\r\n                  </el-select>\r\n                </div>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column\r\n              width=\"140\"\r\n              label=\"小麦数量\">\r\n              <template slot-scope=\"scope\">\r\n                {{scope.row.issueWeight = Number(scope.row.branWeight) +  Number(scope.row.granuleWeight) +  Number(scope.row.scrappedWeight) + Number(scope.row.inStorageWeight) }}\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column\r\n              width=\"140\"\r\n              label=\"麸皮\">\r\n              <template slot-scope=\"scope\">\r\n                <el-input type=\"number\" v-model.number=\"scope.row.branWeight\" :disabled=\"!isRedact || scope.row.status === 'submit' || scope.row.status === 'checked'\" size=\"small\"  placeholder=\"手工录入\"></el-input>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column\r\n              width=\"140\"\r\n              label=\"小颗粒\">\r\n              <template slot-scope=\"scope\">\r\n                <el-input type=\"number\" v-model.number=\"scope.row.granuleWeight\" :disabled=\"!isRedact || scope.row.status === 'submit' || scope.row.status === 'checked'\" size=\"small\"  placeholder=\"手工录入\"></el-input>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column\r\n              width=\"140\"\r\n              label=\"报废小麦\">\r\n              <template slot-scope=\"scope\">\r\n                <el-input type=\"number\" v-model.number=\"scope.row.scrappedWeight\" :disabled=\"!isRedact || scope.row.status === 'submit' || scope.row.status === 'checked'\" size=\"small\"  placeholder=\"手工录入\"></el-input>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column\r\n              width=\"140\"\r\n              label=\"发料批次\">\r\n              <template slot-scope=\"scope\">\r\n                <div class=\"required\">\r\n                  <i class=\"reqI\">*</i>\r\n                  <el-input maxlength='10' v-model=\"scope.row.issueBatch\" :disabled=\"!isRedact || scope.row.status === 'submit' || scope.row.status === 'checked'\" size=\"small\"  placeholder=\"手工录入\"></el-input>\r\n                </div>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column\r\n              width=\"140\"\r\n              label=\"入库数\">\r\n              <template slot-scope=\"scope\">\r\n                <div class=\"required\">\r\n                  <i class=\"reqI\">*</i>\r\n                  <el-input type=\"number\" v-model.number=\"scope.row.inStorageWeight\"  :disabled=\"!isRedact || scope.row.status === 'submit' || scope.row.status === 'checked'\" size=\"small\"  placeholder=\"手工录入\" ></el-input>\r\n                </div>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column\r\n              width=\"140\"\r\n              label=\"入库批次\">\r\n              <template slot-scope=\"scope\">\r\n                <el-input maxlength='10' v-model=\"scope.row.inStorageBatch\" :disabled=\"!isRedact || scope.row.status === 'submit' || scope.row.status === 'checked'\" size=\"small\"  placeholder=\"手工录入\"></el-input>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column\r\n              width=\"140\"\r\n              label=\"库存数\">\r\n              <template slot-scope=\"scope\">\r\n                <el-input type=\"number\" v-model.number=\"scope.row.storageWeight\" :disabled=\"!isRedact || scope.row.status === 'submit' || scope.row.status === 'checked'\" size=\"small\"  placeholder=\"手工录入\"></el-input>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column\r\n              width=\"140\"\r\n              label=\"备注\">\r\n              <template slot-scope=\"scope\">\r\n                <el-input v-model=\"scope.row.remark\" :disabled=\"!isRedact || scope.row.status === 'submit' || scope.row.status === 'checked'\" size=\"small\"  placeholder=\"手工录入\"></el-input>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column\r\n              width=\"200\"\r\n              label=\"生产订单\">\r\n              <template slot-scope=\"scope\">\r\n                {{scope.row.orderNo}}\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column\r\n              fixed=\"right\"\r\n              label=\"操作\"\r\n              width=\"60\">\r\n              <template slot-scope=\"scope\">\r\n                <el-button type=\"danger\" icon=\"el-icon-delete\" circle size=\"small\" :disabled=\"!isRedact || scope.row.status === 'submit' || scope.row.status === 'checked'\"  @click=\"dellistbomS(scope.row)\"></el-button>\r\n              </template>\r\n            </el-table-column>\r\n          </el-table>\r\n        </el-col>\r\n      </el-row>\r\n    </el-card>\r\n    <!--审批-->\r\n    <el-row>\r\n      <el-col :span=\"24\">\r\n        <auditLog :tableData=\"readAudit\"></auditLog>\r\n      </el-col>\r\n    </el-row>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { WHT_API, SYSTEMSETUP_API } from '@/api/api'\r\nimport { dateFormat } from '@/net/validate'\r\n// const DICT_PW_FEVOR = 'PW_FEVOR'\r\n// const DICT_CM_material_prd = 'CM_material_prd'\r\n// const DICT_CM_material = 'CM_material'\r\nexport default {\r\n  data () {\r\n    return {\r\n      dictListObj: {},\r\n      dispatcherCode: '',\r\n      // dispatcherName: '',\r\n      materielDataList: [],\r\n      readAudit: []\r\n    }\r\n  },\r\n  mounted () {\r\n    this.getDictList()\r\n    // this.getMaterielDataList()\r\n  },\r\n  props: {\r\n    isRedact: Boolean,\r\n    appyMaterielState: String,\r\n    order: Object\r\n  },\r\n  methods: {\r\n    // 申请订单\r\n    saveOrderMateriel () {\r\n      if (this.materielDataList.length > 0) {\r\n        // 数据验证\r\n        if (this.validate('apply')) {\r\n          for (let item of this.materielDataList) {\r\n            item.status = 'submit'\r\n            // item.productDate = this.order && this.order.productDate\r\n          }\r\n          this.$http(`${WHT_API.MATERIELSAVEORDER_API}`, 'POST', this.materielDataList).then(({data}) => {\r\n            if (data.code === 0) {\r\n              // 申请订单成功，订单号回写，触发全局刷新\r\n              this.$emit('updateOrderInfo', {orderId: data.orderId, orderNo: data.orderNo})\r\n            } else {\r\n              this.$message.error(data.msg || '申请订单失败，请稍后尝试')\r\n            }\r\n          }).catch((error) => {\r\n            console.log('catch data::', error)\r\n          })\r\n        }\r\n      }\r\n    },\r\n    // 保存/提交\r\n    saveMateriel (resolve) {\r\n      if (this.materielDataList.length > 0) {\r\n        this.materielDataList.forEach((item) => {\r\n          // 应产品要求，如果对不通过数据做修改保存操作，页签状态还是未通过，故此处不做状态赋值。\r\n          // if (item.status !== 'submit' || item.status !== 'checked') {\r\n          //   item.status = 'saved'\r\n          // }\r\n          // 新增行赋值saved\r\n          if (typeof item.status === 'undefined' || item.status == null || item.status.trim() === '') {\r\n            item.status = 'saved'\r\n          }\r\n        })\r\n        this.$http(WHT_API.MATERIELSAVE_API, 'POST', this.materielDataList).then(({data}) => {\r\n          if (data.code === 0) {\r\n          } else {\r\n            this.$message.error(data.msg)\r\n          }\r\n          if (resolve) {\r\n            resolve('resolve')\r\n          }\r\n        }).catch((error) => {\r\n          console.log('catch data::', error)\r\n        })\r\n      } else {\r\n        if (resolve) {\r\n          resolve('resolve')\r\n        }\r\n      }\r\n    },\r\n    submitMateriel (resolve) {\r\n      if (this.materielDataList.length > 0) {\r\n        this.materielDataList.forEach((item) => {\r\n          if (item.status !== 'checked') {\r\n            item.status = 'submit'\r\n          }\r\n        })\r\n        this.$http(WHT_API.MATERIELSUBMIT_API, 'POST', this.materielDataList).then(({data}) => {\r\n          if (data.code === 0) {\r\n          } else {\r\n            this.$message.error(data.msg)\r\n          }\r\n          if (resolve) {\r\n            resolve('resolve')\r\n          }\r\n        }).catch((error) => {\r\n          console.log('catch data::', error)\r\n        })\r\n      } else {\r\n        if (resolve) {\r\n          resolve('resolve')\r\n        }\r\n      }\r\n    },\r\n    validate (flag) {\r\n      for (let item of this.materielDataList) {\r\n        if (item.delFlag === '0') {\r\n          if (item.dispatchMan === null || item.dispatchMan.trim() === '') {\r\n            this.$message.error('生产调度员不能为空')\r\n            return false\r\n          }\r\n          if (item.productCode === null || item.productCode.trim() === '') {\r\n            this.$message.error('生产物料不能为空')\r\n            return false\r\n          }\r\n          if (item.issueCode === null || item.issueCode.trim() === '') {\r\n            this.$message.error('发料料号不能为空')\r\n            return false\r\n          }\r\n          if (item.productWeight === '') {\r\n            this.$message.error('生产数不能为空')\r\n            return false\r\n          }\r\n          if (item.issueBatch === null || item.issueBatch.trim() === '') {\r\n            this.$message.error('发料批次不能为空')\r\n            return false\r\n          }\r\n          if (item.issueBatch.trim().length > 10) {\r\n            this.$message.error('发料批次长度不能超过10')\r\n            return false\r\n          }\r\n          if (item.inStorageWeight === '') {\r\n            this.$message.error('入库数不能为空')\r\n            return false\r\n          }\r\n          if (flag && flag === 'submit') {\r\n            // 提交的时候验证，申请订单不验证\r\n            if (item.inStorageBatch === null || item.inStorageBatch.trim() === '') {\r\n              this.$message.error('入库批次不能为空')\r\n              return false\r\n            }\r\n          }\r\n          if (item.inStorageBatch && item.inStorageBatch.trim().length > 10) {\r\n            this.$message.error('入库批次长度不能超过10')\r\n            return false\r\n          }\r\n        }\r\n      }\r\n      return true\r\n    },\r\n    getDictList (order) {\r\n      // CM_material 发料物料 CM_material_prd 生产物料 PW_FEVOR  生产调度员\r\n      this.dictListObj = {}\r\n      // let params = {types: ['PW_FEVOR', 'CM_material_prd', 'CM_material'], factory: order.factory}\r\n      let params = ['PW_FEVOR', 'CM_material_prd', 'CM_material']\r\n      this.$http(`${SYSTEMSETUP_API.PARAMETERSLIST_API}`, 'POST', params).then(({data}) => {\r\n        if (data.code === 0) {\r\n          for (let dict of data.dicList) {\r\n            this.$set(this.dictListObj, dict.shname, dict.prolist)\r\n          }\r\n        } else {\r\n          this.$message.error(data.msg)\r\n        }\r\n      }).catch((error) => {\r\n        console.log('catch data::', error)\r\n      })\r\n    },\r\n    getMaterielDataList (orderId) {\r\n      // if (typeof this.order === 'undefined' || typeof this.order.orderId === 'undefined') {\r\n      //   return\r\n      // }\r\n      // console.log('为什么拿不到orderId', this.order.orderId)\r\n      this.materielDataList = []\r\n      this.readAudit = []\r\n      let inState = ''\r\n      this.$http(`${WHT_API.MATERIELLIST_API}`, 'POST', {orderId}, false, false, false).then(({data}) => {\r\n        if (data.code === 0) {\r\n          this.materielDataList = data.wlist\r\n          this.readAudit = data.vrlist\r\n          let no = 0\r\n          let sub = 0\r\n          let che = 0\r\n          let sav = 0\r\n          this.materielDataList.forEach((item) => {\r\n            if (item.status === 'noPass') {\r\n              no = no + 1\r\n            } else if (item.status === 'submit') {\r\n              sub = sub + 1\r\n            } else if (item.status === 'checked') {\r\n              che = che + 1\r\n            } else if (item.status === 'saved') {\r\n              sav = sav + 1\r\n            }\r\n          })\r\n          if (no > 0) {\r\n            inState = 'noPass'\r\n          } else if (sub > 0) {\r\n            inState = 'submit'\r\n          } else if (sav > 0) {\r\n            inState = 'saved'\r\n          } else if (che > 0) {\r\n            inState = 'checked'\r\n          }\r\n          // this.$emit('setAppyMaterielState', inState)\r\n        } else {\r\n          this.$message.error(data.msg)\r\n        }\r\n      }).catch((error) => {\r\n        console.log('catch data::', error)\r\n      }).finally(() => {\r\n        this.$emit('setAppyMaterielState', inState)\r\n      })\r\n    },\r\n    // 新增记录\r\n    addNewRecord () {\r\n      let lastArr = this.materielDataList.filter(item => { return item.delFlag === '0' })\r\n      let last = lastArr && lastArr.length > 0 ? lastArr[lastArr.length - 1] : null\r\n      let nowStr = dateFormat(new Date(), 'yyyy-MM-dd hh:mm:ss')\r\n      let user = this.$store.state.user.realName\r\n      this.materielDataList.push({\r\n        branWeight: last ? last.branWeight : 0,\r\n        delFlag: '0',\r\n        dispatchMan: this.dispatcherCode,\r\n        gmCode: '02',\r\n        // 小颗粒\r\n        granuleWeight: last ? last.granuleWeight : 0,\r\n        inStorageBatch: last ? last.inStorageBatch : '',\r\n        inStorageWeight: last ? last.inStorageWeight : 0,\r\n        // 发料批次\r\n        issueBatch: last ? last.issueBatch : '',\r\n        issueCode: last ? last.issueCode : '',\r\n        issueName: last ? last.issueName : '',\r\n        // 发料数量\r\n        issueWeight: last ? last.issueWeight : 0,\r\n        productCode: last ? last.productCode : '',\r\n        productName: last ? last.productName : '',\r\n        productUnit: 'KG',\r\n        productWeight: last ? last.productWeight : 0,\r\n        remark: last ? last.remark : '',\r\n        scrappedWeight: last ? last.scrappedWeight : 0,\r\n        storageWeight: last ? last.storageWeight : 0,\r\n        // this.order && this.order.productDate\r\n        productDate: this.order && this.order.productDate,\r\n        // this.order && this.order.factory\r\n        factory: this.order && this.order.factory,\r\n        // this.order && this.order.workShop\r\n        workShop: this.order && this.order.workShop,\r\n        // this.order && this.order.productLine\r\n        productLine: this.order && this.order.productLine,\r\n        created: nowStr,\r\n        creator: user,\r\n        changed: nowStr,\r\n        changer: user,\r\n        // 申请订单之后订单号回写，再次新增，订单号带过来\r\n        orderId: this.order && this.order.orderId,\r\n        orderNo: this.order && this.order.orderNo\r\n      })\r\n    },\r\n    // 删除\r\n    dellistbomS (row) {\r\n      row.delFlag = '1'\r\n    },\r\n    //  RowDelFlag\r\n    rowDelFlag ({row, rowIndex}) {\r\n      if (row.delFlag === '1') {\r\n        return 'rowDel'\r\n      } else {\r\n        return ''\r\n      }\r\n    },\r\n    changeProductWeight: function (row) {\r\n      for (let item of this.materielDataList) {\r\n        if (item.recordId === row.recordId) {\r\n          item.inStorageWeight = item.productWeight\r\n        }\r\n      }\r\n    },\r\n    // changeDispatcher: function () {\r\n    //   let dispatcher = this.dictListObj['PW_FEVOR'].find((item) => item.code === this.dispatcherCode)\r\n    //   if (dispatcher) {\r\n    //     this.dispatcherName = dispatcher.name\r\n    //   }\r\n    // },\r\n    changeProduct: function (row) {\r\n      let product = this.dictListObj['CM_material_prd'].find((item) => item.code === row.productCode)\r\n      if (product) {\r\n        row.productName = product.value\r\n      }\r\n    },\r\n    changeIssue: function (row) {\r\n      let issue = this.dictListObj['CM_material'].find((item) => item.code === row.issueCode)\r\n      if (issue) {\r\n        row.issueName = issue.value\r\n      }\r\n    }\r\n  },\r\n  computed: {\r\n    enableSubmit: function () {\r\n      // 只有进来没订单号的请况下可以提交订单\r\n      return typeof this.order === 'undefined' || typeof this.order.orderId === 'undefined' || this.order.orderId.trim().length === 0\r\n    }\r\n  },\r\n  watch: {\r\n    'order.productDate' (n, o) {\r\n      // 监听头部生产日期\r\n      this.materielDataList.forEach((item) => {\r\n        if (item.status !== 'submit' && item.status !== 'checked') {\r\n          item.productDate = n\r\n        }\r\n      })\r\n    },\r\n    'dispatcherCode' (n, o) {\r\n      // 调度员切换\r\n      this.materielDataList.forEach((item) => {\r\n        if (item.status !== 'submit' && item.status !== 'checked') {\r\n          item.dispatchMan = n\r\n        }\r\n      })\r\n    }\r\n  },\r\n  components: {\r\n    AuditLog: resolve => {\r\n      require(['@/views/components/AuditLog'], resolve)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/views/page/DataEntry/FryWheat/common/pwApplyMateriel.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('el-card',{attrs:{\"body-style\":\"padding-top:10px;\"}},[_c('el-row',[_c('el-col',{attrs:{\"span\":12}},[_c('el-form',{ref:\"form\",attrs:{\"label-width\":\"100px\"}},[_c('el-form-item',{staticStyle:{\"margin-bottom\":\"0px\"},attrs:{\"label\":\"生产调度员\"}},[_c('el-select',{attrs:{\"size\":\"small\",\"value-key\":\"dispatcherCode\",\"placeholder\":\"请选择生产调度员\",\"disabled\":!_vm.isRedact || _vm.appyMaterielState == 'submit' || _vm.appyMaterielState == 'checked'},model:{value:(_vm.dispatcherCode),callback:function ($$v) {_vm.dispatcherCode=$$v},expression:\"dispatcherCode\"}},_vm._l((this.dictListObj['PW_FEVOR']),function(item,index){return _c('el-option',{key:index,attrs:{\"label\":item.code,\"value\":item.code}})}),1)],1)],1)],1),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":12}},[_c('div',{staticClass:\"btn\",staticStyle:{\"float\":\"right\"}},[_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\",\"disabled\":!_vm.isRedact || _vm.appyMaterielState == 'submit' || _vm.appyMaterielState == 'checked'},on:{\"click\":_vm.addNewRecord}},[_vm._v(\"新增\")]),_vm._v(\" \"),_c('el-button',{staticStyle:{\"margin-left\":\"0px\"},attrs:{\"type\":\"primary\",\"size\":\"small\",\"disabled\":!_vm.isRedact || !_vm.enableSubmit},on:{\"click\":_vm.saveOrderMateriel}},[_vm._v(\"申请订单\")])],1)])],1),_vm._v(\" \"),_c('el-row',[_c('el-col',{attrs:{\"span\":24}},[_c('el-table',{ref:\"table1\",staticStyle:{\"width\":\"100%\",\"margin-bottom\":\"20px\"},attrs:{\"header-row-class-name\":\"tableHead\",\"data\":_vm.materielDataList,\"row-class-name\":_vm.rowDelFlag,\"border\":\"\",\"tooltip-effect\":\"dark\"}},[_c('el-table-column',{attrs:{\"label\":\"生产物料\",\"width\":\"220\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('div',{staticClass:\"required\"},[_c('i',{staticClass:\"reqI\"},[_vm._v(\"*\")]),_vm._v(\" \"),_c('el-select',{attrs:{\"value-key\":\"productCode\",\"placeholder\":\"请选择生产物料\",\"disabled\":!_vm.isRedact || scope.row.status === 'submit' || scope.row.status === 'checked',\"size\":\"small\"},on:{\"change\":function($event){return _vm.changeProduct(scope.row)}},model:{value:(scope.row.productCode),callback:function ($$v) {_vm.$set(scope.row, \"productCode\", $$v)},expression:\"scope.row.productCode\"}},_vm._l((_vm.dictListObj['CM_material_prd']),function(item,index){return _c('el-option',{key:index,attrs:{\"label\":item.code + ' ' + item.value,\"value\":item.code}})}),1)],1)]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"width\":\"140\",\"label\":\"生产数\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('div',{staticClass:\"required\"},[_c('i',{staticClass:\"reqI\"},[_vm._v(\"*\")]),_vm._v(\" \"),_c('el-input',{attrs:{\"type\":\"number\",\"disabled\":!_vm.isRedact || scope.row.status === 'submit' || scope.row.status === 'checked',\"size\":\"small\",\"placeholder\":\"手工录入\"},on:{\"input\":function($event){return _vm.changeProductWeight(scope.row)}},model:{value:(scope.row.productWeight),callback:function ($$v) {_vm.$set(scope.row, \"productWeight\", _vm._n($$v))},expression:\"scope.row.productWeight\"}})],1)]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"width\":\"60\",\"label\":\"单位\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(\"\\n              \"+_vm._s(scope.row.productUnit = 'KG')+\"\\n            \")]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"width\":\"220\",\"label\":\"发料料号\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('div',{staticClass:\"required\"},[_c('i',{staticClass:\"reqI\"},[_vm._v(\"*\")]),_vm._v(\" \"),_c('el-select',{attrs:{\"value-key\":\"issueCode\",\"placeholder\":\"请选择发料料号\",\"disabled\":!_vm.isRedact || scope.row.status === 'submit' || scope.row.status === 'checked',\"size\":\"small\"},on:{\"change\":function($event){return _vm.changeIssue(scope.row)}},model:{value:(scope.row.issueCode),callback:function ($$v) {_vm.$set(scope.row, \"issueCode\", $$v)},expression:\"scope.row.issueCode\"}},_vm._l((_vm.dictListObj['CM_material']),function(item,index){return _c('el-option',{key:index,attrs:{\"label\":item.code + ' ' + item.value,\"value\":item.code}})}),1)],1)]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"width\":\"140\",\"label\":\"小麦数量\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(\"\\n              \"+_vm._s(scope.row.issueWeight = Number(scope.row.branWeight) +  Number(scope.row.granuleWeight) +  Number(scope.row.scrappedWeight) + Number(scope.row.inStorageWeight))+\"\\n            \")]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"width\":\"140\",\"label\":\"麸皮\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-input',{attrs:{\"type\":\"number\",\"disabled\":!_vm.isRedact || scope.row.status === 'submit' || scope.row.status === 'checked',\"size\":\"small\",\"placeholder\":\"手工录入\"},model:{value:(scope.row.branWeight),callback:function ($$v) {_vm.$set(scope.row, \"branWeight\", _vm._n($$v))},expression:\"scope.row.branWeight\"}})]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"width\":\"140\",\"label\":\"小颗粒\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-input',{attrs:{\"type\":\"number\",\"disabled\":!_vm.isRedact || scope.row.status === 'submit' || scope.row.status === 'checked',\"size\":\"small\",\"placeholder\":\"手工录入\"},model:{value:(scope.row.granuleWeight),callback:function ($$v) {_vm.$set(scope.row, \"granuleWeight\", _vm._n($$v))},expression:\"scope.row.granuleWeight\"}})]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"width\":\"140\",\"label\":\"报废小麦\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-input',{attrs:{\"type\":\"number\",\"disabled\":!_vm.isRedact || scope.row.status === 'submit' || scope.row.status === 'checked',\"size\":\"small\",\"placeholder\":\"手工录入\"},model:{value:(scope.row.scrappedWeight),callback:function ($$v) {_vm.$set(scope.row, \"scrappedWeight\", _vm._n($$v))},expression:\"scope.row.scrappedWeight\"}})]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"width\":\"140\",\"label\":\"发料批次\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('div',{staticClass:\"required\"},[_c('i',{staticClass:\"reqI\"},[_vm._v(\"*\")]),_vm._v(\" \"),_c('el-input',{attrs:{\"maxlength\":\"10\",\"disabled\":!_vm.isRedact || scope.row.status === 'submit' || scope.row.status === 'checked',\"size\":\"small\",\"placeholder\":\"手工录入\"},model:{value:(scope.row.issueBatch),callback:function ($$v) {_vm.$set(scope.row, \"issueBatch\", $$v)},expression:\"scope.row.issueBatch\"}})],1)]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"width\":\"140\",\"label\":\"入库数\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('div',{staticClass:\"required\"},[_c('i',{staticClass:\"reqI\"},[_vm._v(\"*\")]),_vm._v(\" \"),_c('el-input',{attrs:{\"type\":\"number\",\"disabled\":!_vm.isRedact || scope.row.status === 'submit' || scope.row.status === 'checked',\"size\":\"small\",\"placeholder\":\"手工录入\"},model:{value:(scope.row.inStorageWeight),callback:function ($$v) {_vm.$set(scope.row, \"inStorageWeight\", _vm._n($$v))},expression:\"scope.row.inStorageWeight\"}})],1)]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"width\":\"140\",\"label\":\"入库批次\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-input',{attrs:{\"maxlength\":\"10\",\"disabled\":!_vm.isRedact || scope.row.status === 'submit' || scope.row.status === 'checked',\"size\":\"small\",\"placeholder\":\"手工录入\"},model:{value:(scope.row.inStorageBatch),callback:function ($$v) {_vm.$set(scope.row, \"inStorageBatch\", $$v)},expression:\"scope.row.inStorageBatch\"}})]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"width\":\"140\",\"label\":\"库存数\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-input',{attrs:{\"type\":\"number\",\"disabled\":!_vm.isRedact || scope.row.status === 'submit' || scope.row.status === 'checked',\"size\":\"small\",\"placeholder\":\"手工录入\"},model:{value:(scope.row.storageWeight),callback:function ($$v) {_vm.$set(scope.row, \"storageWeight\", _vm._n($$v))},expression:\"scope.row.storageWeight\"}})]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"width\":\"140\",\"label\":\"备注\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-input',{attrs:{\"disabled\":!_vm.isRedact || scope.row.status === 'submit' || scope.row.status === 'checked',\"size\":\"small\",\"placeholder\":\"手工录入\"},model:{value:(scope.row.remark),callback:function ($$v) {_vm.$set(scope.row, \"remark\", $$v)},expression:\"scope.row.remark\"}})]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"width\":\"200\",\"label\":\"生产订单\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(\"\\n              \"+_vm._s(scope.row.orderNo)+\"\\n            \")]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"fixed\":\"right\",\"label\":\"操作\",\"width\":\"60\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-button',{attrs:{\"type\":\"danger\",\"icon\":\"el-icon-delete\",\"circle\":\"\",\"size\":\"small\",\"disabled\":!_vm.isRedact || scope.row.status === 'submit' || scope.row.status === 'checked'},on:{\"click\":function($event){return _vm.dellistbomS(scope.row)}}})]}}])})],1)],1)],1)],1),_vm._v(\" \"),_c('el-row',[_c('el-col',{attrs:{\"span\":24}},[_c('auditLog',{attrs:{\"tableData\":_vm.readAudit}})],1)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler?{\"id\":\"data-v-276158fa\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.3@vue-loader/lib/selector.js?type=template&index=0!./src/views/page/DataEntry/FryWheat/common/pwApplyMateriel.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-276158fa\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=styles&index=0!./pwApplyMateriel.vue\")\n}\nvar normalizeComponent = require(\"!../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./pwApplyMateriel.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./pwApplyMateriel.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-276158fa\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=template&index=0!./pwApplyMateriel.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-276158fa\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/page/DataEntry/FryWheat/common/pwApplyMateriel.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}