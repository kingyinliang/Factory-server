webpackJsonp([81],{eOZK:function(t,e){},kn57:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=o("P9l9"),a={name:"index",data:function(){return{factory:[],workshop:[],plantList:{factoryid:"",workShop:"",orderNo:"",productDate:""},list:[],workShop:"",productDate:"",factoryid:"",workShopname:""}},watch:{"plantList.factoryid":function(t,e){this.Getdeptbyid(t)}},mounted:function(){""===this.PkgproductDate?this.plantList.productDate=new Date(new Date-864e5).getFullYear().toString()+(new Date(new Date-864e5).getMonth()+1>=10?(new Date(new Date-864e5).getMonth()+1).toString():"0"+(new Date(new Date-864e5).getMonth()+1))+(new Date(new Date-864e5).getDate()>=10?new Date(new Date-864e5).getDate().toString():"0"+new Date(new Date-864e5).getDate()):this.plantList.productDate=this.PkgproductDate,this.plantList.factoryid=this.Pkgfactoryid,this.Getdeptcode();var t=this;setTimeout(function(){t.plantList.workShop&&t.GetOrderList()},1e3)},methods:{Getdeptcode:function(){var t=this;this.$http(r.c.FINDORG_API+"?code=factory","POST").then(function(e){var o=e.data;0===o.code?(t.factory=o.typeList,t.plantList.factoryid||(t.plantList.factoryid=o.typeList[0].deptId)):t.$message.error(o.msg)})},Getdeptbyid:function(t,e){var o=this;this.plantList.workShop="",console.log(this.plantList.workShop),t&&this.$http(""+r.c.FINDORGBYID_API,"POST",{deptId:t,deptName:"包装 组装"}).then(function(t){var e=t.data;0===e.code?(o.workshop=e.typeList,""===o.PkgworkShop&&""===o.plantList.workShop?o.plantList.workShop=e.typeList[0].deptId:o.plantList.workShop=o.PkgworkShop):o.$message.error(e.msg)})},GetOrderList:function(){var t=this;this.plantList.workShop?this.$http(""+r.h.PKGORDELIST_API,"POST",{factory:this.plantList.factoryid,workShop:this.plantList.workShop,productDate:this.plantList.productDate,orderNo:""}).then(function(e){var o=e.data;0===o.code?(t.Pkgfactoryid=t.plantList.factoryid,t.PkgworkShop=t.plantList.workShop,t.PkgproductDate=t.plantList.productDate,t.list=t.orderList(o.list),t.workShop=t.plantList.workShop,t.productDate=t.plantList.productDate,t.factoryid=t.plantList.factoryid):t.$message.error(o.msg)}):this.$message.error("请选择车间")},orderchange:function(t){var e=this;t.orderNo&&t.orderNo!==t.orderNo2&&this.$http(""+r.h.PKGORDELIST_API,"POST",{factory:this.factoryid,workShop:this.workShop,productDate:this.productDate,orderNo:t.orderNo},!1,!1,!1).then(function(o){var r=o.data;0===r.code?(t.orderNo2=t.orderNo,t.materialCode=r.list[0].materialCode,t.materialName=r.list[0].materialName,t.planOutput=r.list[0].planOutput,t.orderStatus=r.list[0].orderStatus,t.outputUnit=r.list[0].outputUnit,t.properties=r.list[0].properties,t.realOutput=r.list[0].realOutput,t.plan=r.list[0].plan):e.$message.error(r.msg)})},orderList:function(t){for(var e=[],o=0;o<t.length;o++){for(var r=[t[o].orderNo],a=o+1;a<t.length;a++)t[o].productLine===t[a].productLine&&(a=++o,r.push(t[a].orderNo));var i="";i=1===r.length?r[0]:"",e.push({img:t[o].img,productLine:t[o].productLine,productLineName:t[o].productLineName,orderNo:i,orderNo2:"",order_arr:r,realOutput:"",materialCode:"",materialName:"",orderStatus:"",planOutput:"",outputUnit:"",properties:""})}return e},setworkShopname:function(t){this.workShopname=t},goPro:function(t){if(t.orderNo&&t.properties){this.PkgorderNo=t.orderNo,this.PkgproductDate=this.productDate,this.PkgworkShop=this.workShop,this.mainTabs=this.mainTabs.filter(function(t){return"DataEntry-Packaging-ProDataIn"!==t.name});var e=this;setTimeout(function(){e.$router.push({name:"DataEntry-Packaging-ProDataIn"})},100)}else this.$message.error("请选择订单号")}},computed:{mainTabs:{get:function(){return this.$store.state.common.mainTabs},set:function(t){this.$store.commit("common/updateMainTabs",t)}},mainTabsActiveName:{get:function(){return this.$store.state.common.mainTabsActiveName},set:function(t){this.$store.commit("common/updateMainTabsActiveName",t)}},Pkgfactoryid:{get:function(){return this.$store.state.common.Pkgfactoryid},set:function(t){this.$store.commit("common/updateFactoryid",t)}},PkgworkShop:{get:function(){return this.$store.state.common.PkgworkShop},set:function(t){this.$store.commit("common/updateWorkShop",t)}},PkgproductDate:{get:function(){return this.$store.state.common.PkgproductDate},set:function(t){this.$store.commit("common/updateProductDate",t)}},PkgorderNo:{get:function(){return this.$store.state.common.PkgorderNo},set:function(t){this.$store.commit("common/updateOrderNo",t)}}},components:{}},i={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-col",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.lodingStatus,expression:"lodingStatus",modifiers:{fullscreen:!0,lock:!0}}],attrs:{"element-loading-text":"加载中"}},[o("div",{staticClass:"main"},[o("el-card",[o("el-form",{ref:"",attrs:{model:t.plantList,size:"small",inline:!0,"label-position":"left","label-width":"55px"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.GetOrderList()},submit:function(t){t.preventDefault()}}},[o("el-form-item",{attrs:{label:"工厂："}},[o("el-select",{attrs:{placeholder:"请选择"},model:{value:t.plantList.factoryid,callback:function(e){t.$set(t.plantList,"factoryid",e)},expression:"plantList.factoryid"}},[o("el-option",{attrs:{label:"",value:""}}),t._v(" "),t._l(t.factory,function(t,e){return o("el-option",{key:e,attrs:{label:t.deptName,value:t.deptId}})})],2)],1),t._v(" "),o("el-form-item",{attrs:{label:"车间："}},[o("el-select",{attrs:{placeholder:"请选择"},on:{change:t.setworkShopname},model:{value:t.plantList.workShop,callback:function(e){t.$set(t.plantList,"workShop",e)},expression:"plantList.workShop"}},t._l(t.workshop,function(t,e){return o("el-option",{key:e,attrs:{label:t.deptName,value:t.deptId}})}),1)],1),t._v(" "),o("el-form-item",{attrs:{label:"时间："}},[o("el-date-picker",{attrs:{type:"date",placeholder:"选择","value-format":"yyyyMMdd"},model:{value:t.plantList.productDate,callback:function(e){t.$set(t.plantList,"productDate",e)},expression:"plantList.productDate"}})],1),t._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.GetOrderList()}}},[t._v("查询")])],1)],1),t._v(" "),o("el-row",{attrs:{gutter:10}},t._l(t.list,function(e,r){return o("el-col",{key:r,staticStyle:{"margin-bottom":"10px"},attrs:{span:12}},[o("el-card",{staticClass:"box-card"},[o("el-form",{attrs:{model:e,size:"small","label-position":"right","label-width":"85px"}},[o("div",{staticClass:"clearfix pro-line"},[o("el-form-item",{attrs:{label:"产线："}},[o("p",[t._v("\n                  "+t._s(e.productLineName)+"\n                  "),t.isAuth("pkg:order:list")?o("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"small"},on:{click:function(o){return t.goPro(e)}}},[t._v("数据录入")]):t._e(),t._v(" "),o("span",{staticStyle:{float:"right",color:"#8a979e","font-size":"14px","min-width":"150px"}},[t._v("订单状态："),o("i",{style:{color:"noPass"===e.orderStatus?"red":"checked"===e.orderStatus?"#67C23A":""}},[t._v(t._s("submit"===e.orderStatus?"已提交":"checked"===e.orderStatus?"审核通过":"noPass"===e.orderStatus?"审核不通过":"saved"===e.orderStatus?"已保存":"已同步"===e.orderStatus?"未录入":e.orderStatus))])])],1)])],1),t._v(" "),o("div",{staticClass:"clearfix item"},[o("img",{attrs:{src:"data:image/gif;base64,"+e.img,alt:""}}),t._v(" "),o("div",{staticClass:"itemForm"},[o("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"订单号："}},[o("el-select",{attrs:{placeholder:"请选择",change:t.orderchange(e)},model:{value:e.orderNo,callback:function(o){t.$set(e,"orderNo",o)},expression:"item.orderNo"}},[o("el-option",{attrs:{label:"",value:""}}),t._v(" "),t._l(e.order_arr,function(t,e){return o("el-option",{key:e,attrs:{label:t,value:t}})})],2)],1),t._v(" "),o("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"品项："}},[o("p",{staticClass:"hiddenP"},[t._v(t._s(e.materialCode+" "+e.materialName))])]),t._v(" "),o("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"计划产量："}},[o("p",[t._v(t._s(e.planOutput+" "+e.outputUnit))])]),t._v(" "),o("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"实时产量："}},[o("p",[t._v(t._s(e.realOutput?e.realOutput+e.outputUnit:"0 "+e.outputUnit))])])],1)])])],1)],1)}),1)],1)],1)])},staticRenderFns:[]};var s=o("C7Lr")(a,i,!1,function(t){o("eOZK")},"data-v-9c93e0d6",null);e.default=s.exports}});
//# sourceMappingURL=81.cad4ac1e2bfcc3022184.js.map